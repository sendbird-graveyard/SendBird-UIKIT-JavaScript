{"version":3,"file":"OpenChannel.js","sources":["../../../src/smart-components/OpenchannelConversation/utils.ts","../../../src/smart-components/OpenchannelConversation/components/MessageInpuetWrapper.tsx","../../../src/smart-components/OpenchannelConversation/components/FrozenNotification.tsx","../../../src/ui/OpenchannelConversationHeader/index.tsx","../../../src/ui/OpenchannelUserMessage/utils.ts","../../../src/utils/openChannelUtils.ts","../../../src/ui/OpenchannelUserMessage/index.tsx","../../../src/ui/OpenChannelAdminMessage/index.tsx","../../../src/ui/OpenchannelOGMessage/utils.ts","../../../src/ui/OpenchannelOGMessage/index.tsx","../../../src/ui/OpenchannelThumbnailMessage/utils.ts","../../../src/ui/OpenchannelThumbnailMessage/index.tsx","../../../src/ui/OpenchannelFileMessage/utils.ts","../../../src/ui/OpenchannelFileMessage/index.tsx","../../../src/smart-components/OpenchannelConversation/components/RemoveMessageModal.tsx","../../../src/smart-components/OpenchannelConversation/components/types.ts","../../../src/smart-components/OpenchannelConversation/components/MessageHOC.tsx","../../../src/smart-components/OpenchannelConversation/components/OpenchannelConversationScroll.tsx","../../../src/smart-components/OpenchannelConversation/dux/actionTypes.ts","../../../src/smart-components/OpenchannelConversation/dux/reducers.ts","../../../src/smart-components/OpenchannelConversation/dux/initialState.ts","../../../src/smart-components/OpenchannelConversation/index.tsx"],"sourcesContent":["import format from 'date-fns/format';\nimport Sendbird from 'sendbird';\nimport SendbirdUIKit from '../../index';\n\nexport const getMessageCreatedAt = (message: SendbirdUIKit.EveryMessage): string => format(message.createdAt, 'p');\n\nexport const scrollIntoLast = (selector: string, intialTry = 0): void => {\n  const MAX_TRIES = 10;\n  const currentTry = intialTry;\n  if (currentTry > MAX_TRIES) {\n    return;\n  }\n  try {\n    const nodes = document.querySelectorAll(selector);\n    const last = nodes[nodes.length - 1];\n    last.scrollIntoView(false); /** alignToTop: false */\n  } catch (error) {\n    setTimeout(() => {\n      scrollIntoLast(selector, currentTry + 1);\n    }, 500 * currentTry);\n  }\n};\n\n\nexport const isSameGroup = (\n  message: SendbirdUIKit.EveryMessage,\n  comparingMessage: SendbirdUIKit.EveryMessage,\n): boolean => {\n  if (\n    !message\n    || !comparingMessage\n    || message.messageType === 'admin'\n    || comparingMessage.messageType === 'admin'\n  ) {\n    return false\n  }\n\n  return (\n    message.sendingStatus === comparingMessage.sendingStatus\n    && message.sender.userId === comparingMessage.sender.userId\n    && getMessageCreatedAt(message) === getMessageCreatedAt(comparingMessage)\n  );\n};\n\nexport const compareMessagesForGrouping = (\n  prevMessage: SendbirdUIKit.EveryMessage,\n  currMessage: SendbirdUIKit.EveryMessage,\n  nextMessage: SendbirdUIKit.EveryMessage,\n): [boolean, boolean] => (\n    [\n      isSameGroup(prevMessage, currMessage),\n      isSameGroup(currMessage, nextMessage),\n    ]\n  );\n\nexport const kFormatter = (num: number): string => {\n  if (Math.abs(num) > 999999) {\n    return `${(Math.abs(num) / 1000000).toFixed(1)}M`;\n  }\n\n  if (Math.abs(num) > 999) {\n    return `${(Math.abs(num) / 1000).toFixed(1)}K`;\n  }\n\n  return `${num}`;\n};\n\nexport const isOperator = (openChannel: Sendbird.OpenChannel, userId: string): boolean => {\n  const { operators } = openChannel;\n  if (operators.map(operator => operator.userId).indexOf(userId) < 0) {\n    return false;\n  }\n  return true;\n};\n\nexport const isDisabledBecauseFrozen = (openChannel: Sendbird.OpenChannel, userId: string): boolean => {\n  const { isFrozen } = openChannel;\n  return isFrozen && !isOperator(openChannel, userId);\n};\n\nexport const isDisabledBecauseMuted = (mutedParticipantIds: string[], userId: string): boolean => {\n  return mutedParticipantIds.indexOf(userId) < 0;\n};\n","import React, { useContext } from 'react';\nimport Sendbird from 'sendbird';\nimport { RenderMessageInputProps } from '../../../index';\nimport { LocalizationContext } from '../../../lib/LocalizationContext';\nimport MessageInput from '../../../ui/MessageInput';\n\ninterface Props {\n  channel: Sendbird.OpenChannel;\n  user: Sendbird.User;\n  disabled: boolean;\n  onSendMessage(): void;\n  onFileUpload(file_: File): void;\n  renderMessageInput?(renderProps: RenderMessageInputProps): JSX.Element;\n}\n\nconst MessageInputWrapper = ({\n  channel,\n  user,\n  disabled,\n  onSendMessage,\n  onFileUpload,\n  renderMessageInput,\n}: Props, ref: React.RefObject<HTMLInputElement>): JSX.Element => {\n  if (!channel) {\n    return;\n  }\n\n  const { stringSet } = useContext(LocalizationContext);\n\n  if (renderMessageInput) {\n    return renderMessageInput({ channel, user, disabled });\n  }\n\n  return (\n    <div className=\"sendbird-openchannel-footer\">\n      <MessageInput\n        ref={ref}\n        disabled={disabled}\n        onSendMessage={onSendMessage}\n        onFileUpload={onFileUpload}\n        placeholder={(\n          disabled\n          && stringSet.CHANNEL__MESSAGE_INPUT__PLACE_HOLDER__DISABLED\n          // add disabled because of muted state\n        )}\n      />\n    </div>\n  );\n};\n\nexport default React.forwardRef(MessageInputWrapper);\n","import React, { useContext } from 'react';\n\nimport './frozen-notification.scss';\n\nimport { LocalizationContext } from '../../../lib/LocalizationContext';\nimport Label, { LabelTypography } from '../../../ui/Label';\n\nconst FrozenNotification = (): JSX.Element => {\n  const { stringSet } = useContext(LocalizationContext);\n  return (\n    <div className=\"sendbird-frozen-channel-notification\">\n      <Label\n        className=\"sendbird-frozen-channel-notification__text\"\n        type={LabelTypography.CAPTION_2}\n      >\n        {stringSet.CHANNEL_FROZEN}\n      </Label>\n    </div>\n  );\n}\n\nexport default FrozenNotification;\n","import React, { ReactElement } from 'react';\nimport './index.scss';\n\nimport Avatar from '../Avatar';\nimport Icon, { IconColors, IconTypes } from '../Icon';\nimport IconButton from '../IconButton';\nimport Label, {\n  LabelTypography,\n  LabelColors,\n  LabelStringSet,\n} from '../Label';\n\nconst COMPONENT_CLASS_NAME = 'sendbird-openchannel-conversation-header';\n\ninterface Props {\n  coverImage?: string;\n  title?: string;\n  subTitle?: string;\n  onActionClick?(): void;\n}\n\nexport default function OpenchannelConversationHeader({\n  coverImage,\n  title = LabelStringSet.NO_TITLE,\n  subTitle = LabelStringSet.NO_TITLE,\n  onActionClick,\n}: Props): ReactElement {\n  return (\n\n    <div className={COMPONENT_CLASS_NAME}>\n      <div className={`${COMPONENT_CLASS_NAME}__left`}>\n        {\n          coverImage ? (\n            <Avatar\n              className={`${COMPONENT_CLASS_NAME}__left__cover-image`}\n              src={coverImage}\n              alt=\"channel cover image\"\n              width=\"32px\"\n              height=\"32px\"\n            />\n          ) : (\n              <Icon\n                className={`${COMPONENT_CLASS_NAME}__left__cover-image--icon`}\n                width=\"32px\"\n                height=\"32px\"\n                type={IconTypes.AVATAR_NO_IMAGE}\n                fillColor={IconColors.BACKGROUND_3}\n              />\n            )\n        }\n        <Label\n          className={`${COMPONENT_CLASS_NAME}__left__title`}\n          type={LabelTypography.H_2}\n          color={LabelColors.ONBACKGROUND_1}\n        >\n          {title}\n        </Label>\n        <Label\n          className={`${COMPONENT_CLASS_NAME}__left__sub-title`}\n          type={LabelTypography.BODY_2}\n          color={LabelColors.ONBACKGROUND_2}\n        >\n          {subTitle}\n        </Label>\n      </div>\n      <div className={`${COMPONENT_CLASS_NAME}__right`}>\n        <IconButton\n          className={`${COMPONENT_CLASS_NAME}__right__trigger`}\n          width=\"32px\"\n          height=\"32px\"\n          onClick={onActionClick}\n        >\n          <Icon\n            type={IconTypes.INFO}\n            fillColor={IconColors.PRIMARY}\n            width=\"24px\"\n            height=\"24px\"\n          />\n        </IconButton>\n      </div>\n    </div>\n  );\n}\n","export const copyToClipboard = (text: string): boolean => {\n  // @ts-ignore: Unreachable code error\n  if (window.clipboardData && window.clipboardData.setData) {\n    // Internet Explorer-specific code path to prevent textarea being shown while dialog is visible.\n    // @ts-ignore: Unreachable code error\n    return window.clipboardData.setData('Text', text);\n  }\n  if (document.queryCommandSupported && document.queryCommandSupported('copy')) {\n    const textarea = document.createElement('textarea');\n    textarea.textContent = text;\n    textarea.style.position = 'fixed'; // Prevent scrolling to bottom of page in Microsoft Edge.\n    document.body.appendChild(textarea);\n    textarea.select();\n    try {\n      return document.execCommand('copy'); // Security exception may be thrown by some browsers.\n    } catch (ex) {\n      return false;\n    } finally {\n      document.body.removeChild(textarea);\n    }\n  }\n  return false;\n};\n\nexport default { copyToClipboard };\n","import Sendbird from 'sendbird';\nimport { ClientUserMessage, ClientFileMessage } from '../index';\n\nconst OpenChannelMessageStatusTypes = {\n  NONE: 'none',\n  PENDING: 'pending',\n  FAILED: 'failed',\n  CANCELED: 'canceled',\n  SUCCEEDED: 'succeeded'\n};\n\nexport const getSenderFromMessage = (message: ClientUserMessage | ClientFileMessage): Sendbird.User => {\n  return message.sender || message._sender;\n};\n\nexport const checkIsSent = (status: string): boolean => (status === OpenChannelMessageStatusTypes.SUCCEEDED);\n\nexport const checkIsByMe = (message: ClientFileMessage | ClientUserMessage, userId: string): boolean => (getSenderFromMessage(message).userId === userId);\n\ninterface isFineCopyParams {\n  message: ClientUserMessage;\n  status: string;\n  userId: string;\n}\nexport const isFineCopy = ({ message }: isFineCopyParams): boolean => {\n  return (message.messageType === 'user' && message.message.length > 0);\n};\n\ninterface isFineResendParams {\n  message: ClientFileMessage | ClientUserMessage;\n  status: string;\n  userId: string;\n}\nexport const isFineResend = ({ message, status, userId }: isFineResendParams): boolean => {\n  return checkIsByMe(message, userId)\n    && !checkIsSent(status)\n    && message.isResendable\n    && message.isResendable();\n};\n\ninterface isFineEditParams {\n  message: ClientUserMessage;\n  status: string;\n  userId: string;\n}\nexport const isFineEdit = ({ message, status, userId }: isFineEditParams): boolean => {\n  return checkIsByMe(message, userId) && checkIsSent(status);\n};\n\ninterface isFineDeleteParams {\n  message: ClientFileMessage | ClientUserMessage;\n  status: string;\n  userId: string;\n}\nexport const isFineDelete = ({ message, userId }: isFineDeleteParams): boolean => {\n  return checkIsByMe(message, userId);\n};\n\ninterface showMenuTriggerParams {\n  message: ClientUserMessage | ClientFileMessage;\n  status: string;\n  userId: string;\n}\nexport const showMenuTrigger = (props: showMenuTriggerParams): boolean => {\n  const { message, status, userId } = props;\n  if (message.messageType === 'user') {\n    return (\n      isFineDelete({ message, status, userId })\n      || isFineEdit({ message, status, userId })\n      || isFineCopy({ message, status, userId })\n      || isFineResend({ message, status, userId })\n    );\n  } else {\n    return (\n      isFineDelete({ message, status, userId })\n      || isFineResend({ message, status, userId })\n    );\n  }\n};\n","import React, {\n  useMemo,\n  useContext,\n  useRef,\n  useState,\n  ReactElement,\n  useEffect,\n} from 'react';\nimport format from 'date-fns/format';\nimport './index.scss';\n\nimport Avatar from '../Avatar';\nimport ContextMenu, { MenuItems, MenuItem } from '../ContextMenu';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport IconButton from '../IconButton';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport UserProfile from '../UserProfile';\nimport { UserProfileContext } from '../../lib/UserProfileContext';\n\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport { copyToClipboard } from './utils';\nimport uuidv4 from '../../utils/uuid';\nimport { ClientUserMessage } from '../../index';\nimport {\n  checkIsByMe,\n  isFineCopy,\n  isFineEdit,\n  isFineResend,\n  isFineDelete,\n  showMenuTrigger,\n} from '../../utils/openChannelUtils';\nimport { getSenderFromMessage } from '../../utils/openChannelUtils';\n\ninterface Props {\n  message: ClientUserMessage;\n  userId: string;\n  className?: string | string[];\n  disabled?: boolean;\n  showEdit(bool: boolean): void;\n  showRemove(bool: boolean): void;\n  resendMessage(message: ClientUserMessage): void;\n  chainTop?: boolean;\n  chainBottom?: boolean;\n  status: string;\n}\n\nexport default function OpenchannelUserMessage({\n  message,\n  className,\n  userId,\n  resendMessage,\n  disabled,\n  showEdit,\n  showRemove,\n  chainTop,\n  status,\n}: Props): ReactElement {\n  if (!message || message.messageType !== 'user') {\n    return null;\n  }\n\n  // hooks\n  const { stringSet } = useContext(LocalizationContext);\n  const { disableUserProfile, renderUserProfile } = useContext(UserProfileContext);\n  const messageRef = useRef(null);\n  const avatarRef = useRef(null);\n  const contextMenuRef = useRef(null);\n  const [contextStyle, setContextStyle] = useState({});\n\n  // consts\n  const injectingClassName = Array.isArray(className) ? className : [className];\n  injectingClassName.push(`sendbird-openchannel-user-message`);\n  const isByMe = checkIsByMe(message, userId);\n  const sender = getSenderFromMessage(message);\n\n  const MemoizedMessageText = useMemo(() => () => {\n    const splitMessage = message.message.split(/\\r/);\n    const matchedMessage = splitMessage.map((word) => (word !== '' ? word : <br />));\n    if (message.updatedAt > 0) {\n      matchedMessage.push(\n        <Label\n          key={uuidv4()}\n          type={LabelTypography.BODY_1}\n          color={LabelColors.ONBACKGROUND_2}\n          calssName=\"sendbird-openchannel-user-message-word\"\n        >\n          {` ${stringSet.MESSAGE_EDITED} `}\n        </Label>,\n      );\n    }\n    return matchedMessage;\n  }, [message, message.updatedAt]);\n\n  // place context menu top depending clientHeight of message component\n  useEffect(() => {\n    if (messageRef.current.clientHeight > 36) {\n      setContextStyle({ top: '8px ' });\n    } else {\n      setContextStyle({ top: '2px' });\n    }\n  }, [window.innerWidth]);\n\n  return (\n    <div\n      className={injectingClassName.join(' ')}\n      ref={messageRef}\n    >\n      <div className=\"sendbird-openchannel-user-message__left\">\n        {\n          !chainTop && (\n            <ContextMenu\n              menuTrigger={(toggleDropdown) => (\n                <Avatar\n                  className=\"sendbird-openchannel-user-message__left__avatar\"\n                  src={sender.profileUrl || ''}\n                  ref={avatarRef}\n                  width=\"28px\"\n                  height=\"28px\"\n                  onClick={() => {\n                    if (!disableUserProfile) {\n                      toggleDropdown();\n                    }\n                  }}\n                />\n              )}\n              menuItems={(closeDropdown) => (\n                <MenuItems\n                  parentRef={avatarRef}\n                  parentContainRef={avatarRef}\n                  closeDropdown={closeDropdown}\n                  style={{ paddingTop: 0, paddingBottom: 0 }}\n                >\n                  {\n                    renderUserProfile\n                    ? (\n                      renderUserProfile({\n                        user: sender,\n                        close: closeDropdown,\n                      })\n                    )\n                    : (\n                      <UserProfile\n                        user={sender}\n                        onSuccess={closeDropdown}\n                        disableMessaging\n                      />\n                    )\n                  }\n                </MenuItems>\n              )}\n            />\n          )\n        }\n      </div>\n      <div className=\"sendbird-openchannel-user-message__right\">\n        {\n          !chainTop && (\n            <div className=\"sendbird-openchannel-user-message__right__top\">\n              <Label\n                className=\"sendbird-openchannel-user-message__right__top__sender-name\"\n                type={LabelTypography.CAPTION_2}\n                color={isByMe ? LabelColors.SECONDARY_3 : LabelColors.ONBACKGROUND_2}\n              >\n                {\n                  sender && (\n                    sender.friendName\n                    || sender.nickname\n                    || sender.userId\n                  )\n                }\n              </Label>\n              <Label\n                className=\"sendbird-openchannel-user-message__right__top__sent-at\"\n                type={LabelTypography.CAPTION_3}\n                color={LabelColors.ONBACKGROUND_3}\n              >\n                {\n                  message.createdAt && (\n                    format(message.createdAt, 'p')\n                  )\n                }\n              </Label>\n            </div>\n          )\n        }\n        <div className=\"sendbird-openchannel-user-message__right__bottom\">\n          <Label\n            className=\"sendbird-openchannel-user-message__right__bottom__message\"\n            type={LabelTypography.BODY_1}\n            color={LabelColors.ONBACKGROUND_1}\n          >\n            {MemoizedMessageText()}\n          </Label>\n        </div>\n      </div>\n      {\n        <div\n          className=\"sendbird-openchannel-user-message__context-menu\"\n          ref={contextMenuRef}\n          style={contextStyle}\n        >\n          <ContextMenu\n            menuTrigger={(toggleDropdown) => (\n              showMenuTrigger({ message: message, userId: userId, status: status}) && (\n                <IconButton\n                  className=\"sendbird-openchannel-user-message__context-menu--icon\"\n                  width=\"32px\"\n                  height=\"32px\"\n                  onClick={() => {\n                    toggleDropdown();\n                  }}\n                >\n                  <Icon\n                    width=\"24px\"\n                    height=\"24px\"\n                    type={IconTypes.MORE}\n                    fillColor={IconColors.CONTENT_INVERSE}\n                  />\n                </IconButton>\n              )\n            )}\n            menuItems={(closeDropdown) => (\n              <MenuItems\n                parentRef={contextMenuRef}\n                parentContainRef={contextMenuRef}\n                closeDropdown={closeDropdown}\n                openLeft\n              >\n                {\n                  isFineCopy({ message: message, userId: userId, status: status }) && (\n                    <MenuItem\n                      className=\"sendbird-openchannel-user-message__context-menu__copy\"\n                      onClick={() => {\n                        copyToClipboard(message.message);\n                        closeDropdown();\n                      }}\n                    >\n                      {stringSet.CONTEXT_MENU_DROPDOWN__COPY}\n                    </MenuItem>\n                  )\n                }\n                {\n                  isFineEdit({ message: message, userId: userId, status: status }) && (\n                    <MenuItem\n                      className=\"sendbird-openchannel-user-message__context-menu__edit\"\n                      onClick={() => {\n                        if (disabled) {\n                          return;\n                        }\n                        showEdit(true);\n                        closeDropdown();\n                      }}\n                    >\n                      {stringSet.CONTEXT_MENU_DROPDOWN__EDIT}\n                    </MenuItem>\n                  )\n                }\n                {\n                  isFineResend({ message: message, userId: userId, status: status }) && (\n                    <MenuItem\n                      className=\"sendbird-openchannel-user-message__context-menu__resend\"\n                      onClick={() => {\n                        resendMessage(message);\n                        closeDropdown();\n                      }}\n                    >\n                      {stringSet.CONTEXT_MENU_DROPDOWN__RESEND}\n                    </MenuItem>\n                  )\n                }\n                {\n                  isFineDelete({ message: message, userId: userId, status: status }) && (\n                    <MenuItem\n                      className=\"sendbird-openchannel-user-message__context-menu__delete\"\n                      onClick={() => {\n                        if (disabled) {\n                          return;\n                        }\n                        showRemove(true);\n                        closeDropdown();\n                      }}\n                    >\n                      {stringSet.CONTEXT_MENU_DROPDOWN__DELETE}\n                    </MenuItem>\n                  )\n                }\n              </MenuItems>\n            )}\n          />\n        </div>\n      }\n    </div>\n  );\n}\n","import React, { ReactElement } from 'react';\nimport { ClientAdminMessage } from '../../index';\nimport './index.scss';\n\nimport Label, { LabelColors, LabelTypography } from '../Label';\n\ninterface Props {\n  message: ClientAdminMessage;\n  className?: string | string[];\n}\n\nexport default function OpenChannelAdminMessage({\n  message,\n  className,\n}: Props): ReactElement {\n  const injectingClassName = Array.isArray(className) ? className : [className];\n  injectingClassName.push('sendbird-openchannel-admin-message');\n\n  return (\n    <div className={[...injectingClassName].join(' ')}>\n      <Label\n        className=\"sendbird-openchannel-admin-message__text\"\n        type={LabelTypography.CAPTION_2}\n        color={LabelColors.ONBACKGROUND_2}\n      >\n        {message.message || ''}\n      </Label>\n    </div>\n  );\n}\n","import Sendbird from 'sendbird';\n\nexport const URL_REG = /[-a-zA-Z0-9@:%._+~#=]{1,256}\\.[a-zA-Z0-9()]{1,6}\\b([-a-zA-Z0-9()@:%_+.~#?&//=]*)/;\nexport const createUrlTester = (regexp: RegExp) => (text: string): boolean => regexp.test(text);\nexport const checkOGIsEnalbed = (message: Sendbird.UserMessage): boolean => {\n  const { ogMetaData } = message;\n  if (!ogMetaData) {\n    return false;\n  }\n  const { url } = ogMetaData;\n  if (!url) {\n    return false;\n  }\n  return true;\n};\n","import React, { useState, useContext, useMemo, useRef, useEffect } from 'react';\nimport format from 'date-fns/format';\nimport './index.scss';\n\nimport Avatar from '../Avatar';\nimport ContextMenu, { MenuItems, MenuItem } from '../ContextMenu';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport IconButton from '../IconButton';\nimport ImageRenderer from '../ImageRenderer';\nimport LinkLabel from '../LinkLabel';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport UserProfile from '../UserProfile';\nimport { UserProfileContext } from '../../lib/UserProfileContext';\n\nimport uuidv4 from '../../utils/uuid';\nimport { copyToClipboard } from '../OpenchannelUserMessage/utils';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport { checkOGIsEnalbed, createUrlTester, URL_REG } from './utils';\nimport { ClientUserMessage } from '../../index';\nimport {\n  checkIsByMe,\n  isFineCopy,\n  isFineEdit,\n  isFineResend,\n  isFineDelete,\n  showMenuTrigger,\n} from '../../utils/openChannelUtils';\nimport { getSenderFromMessage } from '../../utils/openChannelUtils';\n\ninterface Props {\n  message: ClientUserMessage;\n  className?: string | string[];\n  disabled?: boolean;\n  showEdit(bool: boolean): void;\n  showRemove(bool: boolean): void;\n  resendMessage(message: ClientUserMessage): void;\n  chainTop?: boolean;\n  chainBottom?: boolean;\n  status: string;\n  userId: string;\n}\n\nexport default function OpenchannelOGMessage({\n  message,\n  className,\n  disabled,\n  showEdit,\n  showRemove,\n  resendMessage,\n  chainTop,\n  status,\n  userId,\n}: Props): JSX.Element {\n  if (!message || message.messageType !== 'user') {\n    return null;\n  }\n\n  const { ogMetaData } = message;\n  const { defaultImage } = ogMetaData;\n\n  const { stringSet } = useContext(LocalizationContext);\n  const { disableUserProfile, renderUserProfile } = useContext(UserProfileContext);\n  const [contextStyle, setContextStyle] = useState({});\n  const messageComponentRef = useRef(null);\n  const contextMenuRef = useRef(null);\n  const avatarRef = useRef(null);\n\n  const isUrl = createUrlTester(URL_REG);\n  const injectingClassName = Array.isArray(className) ? className : [className];\n  injectingClassName.push('sendbird-openchannel-og-message');\n  const isByMe = checkIsByMe(message, userId);\n  const sender = getSenderFromMessage(message);\n\n  const MemoizedMessageText = useMemo(() => () => {\n    const wordClassName = 'sendbird-openchannel-og-message--word';\n    const splitMessage = message.message.split(' ');\n    const matchedMessage = splitMessage\n      .map((word) => (\n        isUrl(word)\n          ? (\n            <LinkLabel\n              key={uuidv4()}\n              className={[\n                wordClassName,\n                'sendbird-openchannel-og-message--word--link'\n              ]}\n              src={word}\n              type={LabelTypography.BODY_1}\n              color={LabelColors.PRIMARY}\n            >\n              {word}\n            </LinkLabel>\n          )\n          : (\n            <Label\n              key={uuidv4()}\n              className={wordClassName}\n              type={LabelTypography.BODY_1}\n              color={LabelColors.ONBACKGROUND_1}\n            >\n              {word}\n            </Label>\n          )\n      ));\n\n    if (message.updatedAt > 0) {\n      matchedMessage.push(\n        <Label\n          key={uuidv4()}\n          className={wordClassName}\n          type={LabelTypography.BODY_1}\n          color={LabelColors.ONBACKGROUND_2}\n        >\n          {stringSet.MESSAGE_EDITED}\n        </Label>,\n      );\n    }\n\n    return matchedMessage;\n  }, [message, message.updatedAt]);\n\n  const openLink = () => {\n    if (checkOGIsEnalbed(message)) {\n      const { url } = ogMetaData;\n      window.open(url);\n    }\n  };\n\n  // place conxt menu top depending clientHeight of message component\n  useEffect(() => {\n    if (messageComponentRef.current.clientHeight > 36) {\n      setContextStyle({ top: '8px ' });\n    } else {\n      setContextStyle({ top: '2px' });\n    }\n  }, [window.innerWidth]);\n\n  return (\n    <div\n      className={injectingClassName.join(' ')}\n      ref={messageComponentRef}\n    >\n      <div\n        className=\"sendbird-openchannel-og-message__top\"\n      >\n        <div className=\"sendbird-openchannel-og-message__top__left\">\n          {\n            !chainTop && (\n              <ContextMenu\n                menuTrigger={(toggleDropdown) => (\n                  <Avatar\n                    className=\"sendbird-openchannel-og-message__top__left__avatar\"\n                    src={sender.profileUrl || ''}\n                    ref={avatarRef}\n                    width=\"28px\"\n                    height=\"28px\"\n                    onClick={() => {\n                      if (!disableUserProfile) {\n                        toggleDropdown();\n                      }\n                    }}\n                  />\n                )}\n                menuItems={(closeDropdown) => (\n                  <MenuItems\n                    parentRef={avatarRef}\n                    parentContainRef={avatarRef}\n                    closeDropdown={closeDropdown}\n                    style={{ paddingTop: 0, paddingBottom: 0 }}\n                  >\n                    {\n                      renderUserProfile\n                        ? (\n                          renderUserProfile({\n                            user: sender,\n                            close: closeDropdown,\n                          })\n                        )\n                        : (\n                          <UserProfile\n                            user={sender}\n                            onSuccess={closeDropdown}\n                            disableMessaging\n                          />\n                        )\n                    }\n                  </MenuItems>\n                )}\n              />\n            )\n          }\n        </div>\n        <div className=\"sendbird-openchannel-og-message__top__right\">\n          {\n            !chainTop && (\n              <div className=\"sendbird-openchannel-og-message__top__right__title\">\n                <Label\n                  className=\"sendbird-openchannel-og-message__top__right__title__sender-name\"\n                  type={LabelTypography.CAPTION_2}\n                  color={isByMe ? LabelColors.SECONDARY_3 : LabelColors.ONBACKGROUND_2}\n                >\n                  {\n                    sender && (\n                      sender.friendName\n                      || sender.nickname\n                      || sender.userId\n                    )\n                  }\n                </Label>\n                <Label\n                  className=\"sendbird-openchannel-og-message__top__right__title__sent-at\"\n                  type={LabelTypography.CAPTION_3}\n                  color={LabelColors.ONBACKGROUND_3}\n                >\n                  {\n                    message.createdAt && (\n                      format(message.createdAt, 'p')\n                    )\n                  }\n                </Label>\n              </div>\n            )\n          }\n          <div className=\"sendbird-openchannel-og-message__top__right__description\">\n            <Label\n              className=\"sendbird-openchannel-og-message__top__right__description__message\"\n              type={LabelTypography.BODY_1}\n              color={LabelColors.ONBACKGROUND_1}\n            >\n              {MemoizedMessageText()}\n            </Label>\n          </div>\n        </div>\n        {\n          <div\n            className=\"sendbird-openchannel-og-message__top__context-menu\"\n            ref={contextMenuRef}\n            style={contextStyle}\n          >\n            <ContextMenu\n              menuTrigger={(toggleDropdown) => (\n                showMenuTrigger({ message: message, userId: userId, status: status }) && (\n                  <IconButton\n                    className=\"sendbird-openchannel-og-message__top__context-menu--icon\"\n                    width=\"32px\"\n                    height=\"32px\"\n                    onClick={() => {\n                      toggleDropdown();\n                    }}\n                  >\n                    <Icon\n                      width=\"24px\"\n                      height=\"24px\"\n                      type={IconTypes.MORE}\n                      fillColor={IconColors.CONTENT_INVERSE}\n                    />\n                  </IconButton>\n                )\n              )}\n              menuItems={(closeDropdown) => (\n                <MenuItems\n                  parentRef={contextMenuRef}\n                  parentContainRef={contextMenuRef}\n                  closeDropdown={closeDropdown}\n                  openLeft\n                >\n                  {\n                    isFineCopy({ message, userId, status }) && (\n                      <MenuItem\n                        className=\"sendbird-openchannel-og-message__top__context-menu__copy\"\n                        onClick={() => {\n                          copyToClipboard(message.message);\n                          closeDropdown();\n                        }}\n                      >\n                        {stringSet.CONTEXT_MENU_DROPDOWN__COPY}\n                      </MenuItem>\n                    )\n                  }\n                  {\n                    isFineEdit({ message, userId, status }) && (\n                      <MenuItem\n                        className=\"sendbird-openchannel-og-message__top__context-menu__edit\"\n                        onClick={() => {\n                          if (disabled) {\n                            return;\n                          }\n                          showEdit(true);\n                          closeDropdown();\n                        }}\n                      >\n                        {stringSet.CONTEXT_MENU_DROPDOWN__EDIT}\n                      </MenuItem>\n                    )\n                  }\n                  {\n                    isFineResend({ message, userId, status }) && (\n                      <MenuItem\n                        className=\"sendbird-openchannel-og-message__top__context-menu__resend\"\n                        onClick={() => {\n                          resendMessage(message);\n                          closeDropdown();\n                        }}\n                      >\n                        {stringSet.CONTEXT_MENU_DROPDOWN__RESEND}\n                      </MenuItem>\n                    )\n                  }\n                  {\n                    isFineDelete({ message, userId, status }) && (\n                      <MenuItem\n                        className=\"sendbird-openchannel-og-message__top__context-menu__delete\"\n                        onClick={() => {\n                          if (disabled) {\n                            return;\n                          }\n                          showRemove(true);\n                          closeDropdown();\n                        }}\n                      >\n                        {stringSet.CONTEXT_MENU_DROPDOWN__DELETE}\n                      </MenuItem>\n                    )\n                  }\n                </MenuItems>\n              )}\n            />\n          </div>\n        }\n      </div>\n      <div className=\"sendbird-openchannel-og-message__bottom\">\n        <div className=\"sendbird-openchannel-og-message__bottom__og-tag\">\n          {\n            ogMetaData.url && (\n              <Label\n                className=\"sendbird-openchannel-og-message__bottom__og-tag__url\"\n                type={LabelTypography.CAPTION_3}\n                color={LabelColors.ONBACKGROUND_2}\n              >\n                {ogMetaData.url}\n              </Label>\n            )\n          }\n          {\n            ogMetaData.title && (\n              <LinkLabel\n                className=\"sendbird-openchannel-og-message__bottom__og-tag__title\"\n                type={LabelTypography.SUBTITLE_2}\n                color={LabelColors.PRIMARY}\n                src={ogMetaData.url}\n              >\n                {\n                  ogMetaData.title\n                }\n              </LinkLabel>\n            )\n          }\n          {\n            ogMetaData.description && (\n              <Label\n                className=\"sendbird-openchannel-og-message__bottom__og-tag__description\"\n                type={LabelTypography.BODY_2}\n                color={LabelColors.ONBACKGROUND_1}\n              >\n                {ogMetaData.description}\n              </Label>\n            )\n          }\n          {\n            ogMetaData.url && (\n              <div\n                className=\"sendbird-openchannel-og-message__bottom__og-tag__thumbnail\"\n                onClick={openLink}\n                onKeyDown={openLink}\n                role=\"button\"\n                tabIndex={0}\n              >\n                {\n                  defaultImage && (\n                    <ImageRenderer\n                      url={defaultImage.url || ''}\n                      alt={defaultImage.alt || ''}\n                      className=\"sendbird-openchannel-og-message__bottom__og-tag__thumbnail__image\"\n                      height=\"189px\"\n                      defaultComponent={(\n                        <div className=\"sendbird-openchannel-og-message__bottom__og-tag__thumbnail__image--placeholder\">\n                          <Icon\n                            width=\"56px\"\n                            height=\"56px\"\n                            type={IconTypes.NO_THUMBNAIL}\n                          />\n                        </div>\n                      )}\n                    />\n                  )\n                }\n              </div>\n            )\n          }\n        </div>\n      </div>\n    </div>\n  );\n}\n","export const SUPPORTING_TYPES = {\n  IMAGE: 'IMAGE',\n  VIDEO: 'VIDEO',\n  UNSUPPORTED: 'UNSUPPORTED',\n};\n\nconst SUPPORTED_MIMES = {\n  IMAGE: [\n    'image/jpeg',\n    'image/jpg',\n    'image/png',\n    'image/gif',\n    'image/webp',\n  ],\n  VIDEO: [\n    'video/mpeg',\n    'video/ogg',\n    'video/webm',\n    'video/mp4',\n  ],\n};\n\nexport const getSupportingFileType = (type: string): string => {\n  if (SUPPORTED_MIMES.IMAGE.indexOf(type) >= 0) {\n    return SUPPORTING_TYPES.IMAGE;\n  }\n  if (SUPPORTED_MIMES.VIDEO.indexOf(type) >= 0) {\n    return SUPPORTING_TYPES.VIDEO;\n  }\n  return SUPPORTING_TYPES.UNSUPPORTED;\n}\n","import React, { useContext, useRef } from 'react';\nimport format from 'date-fns/format';\nimport './index.scss';\nimport { SUPPORTING_TYPES, getSupportingFileType } from './utils';\nimport { ClientFileMessage } from '../../index';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\n\nimport Avatar from '../Avatar';\nimport ContextMenu, { MenuItems, MenuItem } from '../ContextMenu';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport IconButton from '../IconButton';\nimport ImageRenderer from '../ImageRenderer';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport UserProfile from '../UserProfile';\nimport { UserProfileContext } from '../../lib/UserProfileContext';\nimport {\n  checkIsByMe,\n  checkIsSent,\n  isFineResend,\n  isFineDelete,\n  showMenuTrigger,\n} from '../../utils/openChannelUtils';\nimport { getSenderFromMessage } from '../../utils/openChannelUtils';\n\ninterface Props {\n  message: ClientFileMessage;\n  className?: string | string[];\n  disabled: boolean;\n  userId: string;\n  status: string;\n  chainTop: boolean;\n  chainBottom: boolean;\n  onClick(bool: boolean): void,\n  showRemove(bool: boolean): void,\n  resendMessage(message: ClientFileMessage): void;\n}\n\nexport default function OpenchannelThumbnailMessage({\n  message,\n  className,\n  disabled,\n  userId,\n  status,\n  chainTop,\n  onClick,\n  showRemove,\n  resendMessage,\n}: Props): JSX.Element {\n  const {\n    type,\n    url,\n    localUrl,\n  } = message;\n  const { stringSet } = useContext(LocalizationContext);\n  const { disableUserProfile, renderUserProfile } = useContext(UserProfileContext);\n  const contextMenuRef = useRef(null);\n  const avatarRef = useRef(null);\n\n  const injectingClassName = Array.isArray(className) ? className : [className];\n  injectingClassName.push('sendbird-openchannel-thumbnail-message');\n  const isByMe = checkIsByMe(message, userId);\n  const isMessageSent = checkIsSent(status);\n  const sender = getSenderFromMessage(message);\n\n  return (\n    <div className={injectingClassName.join(' ')}>\n      <div className=\"sendbird-openchannel-thumbnail-message__left\">\n        {\n          !chainTop && (\n            <ContextMenu\n              menuTrigger={(toggleDropdown) => (\n                <Avatar\n                  className=\"sendbird-openchannel-thumbnail-message__left__avatar\"\n                  src={sender.profileUrl || ''}\n                  ref={avatarRef}\n                  width=\"28px\"\n                  height=\"28px\"\n                  onClick={() => {\n                    if (!disableUserProfile) {\n                      toggleDropdown();\n                    }\n                  }}\n                />\n              )}\n              menuItems={(closeDropdown) => (\n                <MenuItems\n                  parentRef={avatarRef}\n                  parentContainRef={avatarRef}\n                  closeDropdown={closeDropdown}\n                  style={{ paddingTop: 0, paddingBottom: 0 }}\n                >\n                  {\n                    renderUserProfile\n                      ? (\n                        renderUserProfile({\n                          user: sender,\n                          close: closeDropdown,\n                        })\n                      )\n                      : (\n                        <UserProfile\n                          user={sender}\n                          onSuccess={closeDropdown}\n                          disableMessaging\n                        />\n                      )\n                  }\n                </MenuItems>\n              )}\n            />\n          )\n        }\n      </div>\n      <div className=\"sendbird-openchannel-thumbnail-message__right\">\n        {\n          !chainTop && (\n            <div className=\"sendbird-openchannel-thumbnail-message__right__title\">\n              <Label\n                className=\"sendbird-openchannel-thumbnail-message__right__title__sender-name\"\n                type={LabelTypography.CAPTION_2}\n                color={isByMe ? LabelColors.SECONDARY_3 : LabelColors.ONBACKGROUND_2}\n              >\n                {\n                  sender && (\n                    sender.friendName\n                    || sender.nickname\n                    || sender.userId\n                  )\n                }\n              </Label>\n              <Label\n                className=\"sendbird-openchannel-thumbnail-message__right__title__sent-at\"\n                type={LabelTypography.CAPTION_3}\n                color={LabelColors.ONBACKGROUND_3}\n              >\n                {\n                  message.createdAt && (\n                    format(message.createdAt, 'p')\n                  )\n                }\n              </Label>\n            </div>\n          )\n        }\n        <div className=\"sendbird-openchannel-thumbnail-message__right__body\">\n          <div\n            className=\"sendbird-openchannel-thumbnail-message__right__body__wrap\"\n            onClick={() => {\n              if (isMessageSent) {\n                onClick(true);\n              }\n            }}\n            onKeyDown={() => {\n              if (isMessageSent) {\n                onClick(true);\n              }\n            }}\n            tabIndex={0}\n            role=\"button\"\n          >\n            <div className=\"sendbird-openchannel-thumbnail-message__right__body__wrap__overlay\" />\n            {\n              {\n                [SUPPORTING_TYPES.VIDEO]: (\n                  (url || localUrl)\n                    ? (\n                      <div className=\"sendbird-openchannel-thumbnail-message__right__body__wrap__video\" >\n                        <video\n                          className=\"sendbird-openchannel-thumbnail-message__right__body__wrap__video__video\"\n                        >\n                          <source src={url || localUrl} type={type} />\n                        </video>\n                        <Icon\n                          className=\"sendbird-openchannel-thumbnail-message__right__body__wrap__video__icon\"\n                          width=\"56px\"\n                          height=\"56px\"\n                          type={IconTypes.PLAY}\n                        />\n                      </div>\n                    )\n                    : (\n                      <Icon\n                        className=\"sendbird-openchannel-thumbnail-message__right__body__wrap__video--icon\"\n                        width=\"56px\"\n                        height=\"56px\"\n                        type={IconTypes.PHOTO}\n                        fillColor={IconColors.ON_BACKGROUND_2}\n                      />\n                    )\n                ),\n                [SUPPORTING_TYPES.IMAGE]: (\n                  (url || localUrl)\n                    ? (\n                      <ImageRenderer\n                        className=\"sendbird-openchannel-thumbnail-message__right__body__wrap__image\"\n                        height=\"270px\"\n                        url={url || localUrl}\n                        alt=\"image\"\n                      />\n                    )\n                    : (\n                      <Icon\n                        className=\"sendbird-openchannel-thumbnail-message__right__body__wrap__image--icon\"\n                        width=\"56px\"\n                        height=\"56px\"\n                        type={IconTypes.PHOTO}\n                        fillColor={IconColors.ON_BACKGROUND_2}\n                      />\n                    )\n                ),\n                [SUPPORTING_TYPES.UNSUPPORTED]: (\n                  <Icon\n                    className=\"sendbird-openchannel-thumbnail-message__right__body__wrap__unknown\"\n                    width=\"56px\"\n                    height=\"56px\"\n                    type={IconTypes.PHOTO}\n                    fillColor={IconColors.ON_BACKGROUND_2}\n                  />\n                ),\n              }[getSupportingFileType(type)]\n            }\n          </div>\n        </div>\n      </div>\n      <div\n        className=\"sendbird-openchannel-thumbnail-message__context-menu\"\n        ref={contextMenuRef}\n      >\n        <ContextMenu\n          menuTrigger={(toggleDropdown) => (\n            showMenuTrigger({ message, userId, status }) && (\n              <IconButton\n                className=\"sendbird-openchannel-thumbnail-message__context-menu--icon\"\n                width=\"32px\"\n                height=\"32px\"\n                onClick={toggleDropdown}\n              >\n                <Icon\n                  width=\"24px\"\n                  height=\"24px\"\n                  type={IconTypes.MORE}\n                  fillColor={IconColors.CONTENT_INVERSE}\n                />\n              </IconButton>\n            )\n          )}\n          menuItems={(closeDropdown) => (\n            <MenuItems\n              parentRef={contextMenuRef}\n              parentContainRef={contextMenuRef}\n              closeDropdown={closeDropdown}\n              openLeft\n            >\n              {\n                isFineResend({ message, userId, status }) && (\n                  <MenuItem\n                    onClick={() => {\n                      resendMessage(message);\n                      closeDropdown();\n                    }}\n                  >\n                    {stringSet.CONTEXT_MENU_DROPDOWN__RESEND}\n                  </MenuItem>\n                )\n              }\n              {\n                isFineDelete({ message, userId, status }) && (\n                  <MenuItem\n                    onClick={() => {\n                      if (disabled) {\n                        return;\n                      }\n                      showRemove(true);\n                      closeDropdown();\n                    }}\n                  >\n                    {stringSet.CONTEXT_MENU_DROPDOWN__DELETE}\n                  </MenuItem>\n                )\n              }\n            </MenuItems>\n          )}\n        />\n      </div>\n    </div>\n  );\n}\n","import { IconTypes } from '../Icon';\n\nexport const checkFileType = (fileUrl: string): string => {\n  let result = null;\n  const imageFile = /(\\.gif|\\.jpg|\\.jpeg|\\.txt|\\.pdf)$/i;\n  const audioFile = /(\\.mp3)$/i;\n  if (imageFile.test(fileUrl)) {\n    result = IconTypes.FILE_DOCUMENT;\n  } else if (audioFile.test(fileUrl)) {\n    result = IconTypes.FILE_AUDIO;\n  }\n  return result;\n}\n\nexport const truncate = (fullStr:string, strLen: number): string => {\n  if (fullStr === null || fullStr === undefined) return '';\n  if (fullStr.length <= strLen) return fullStr;\n  const separator = '...';\n  const sepLen = separator.length;\n  const charsToShow = strLen - sepLen;\n  const frontChars = Math.ceil(charsToShow / 2);\n  const backChars = Math.floor(charsToShow / 2);\n  return fullStr.substr(0, frontChars) + separator + fullStr.substr(fullStr.length - backChars);\n};\n","import React, { useContext, useRef } from 'react';\nimport format from 'date-fns/format';\nimport './index.scss';\n\nimport Avatar from '../Avatar';\nimport ContextMenu, { MenuItems, MenuItem } from '../ContextMenu';\nimport Label, { LabelTypography, LabelColors } from '../Label';\nimport Icon, { IconTypes, IconColors } from '../Icon';\nimport IconButton from '../IconButton';\nimport TextButton from '../TextButton';\nimport UserProfile from '../UserProfile';\nimport { UserProfileContext } from '../../lib/UserProfileContext';\n\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport { checkFileType, truncate } from './utils';\nimport { ClientFileMessage } from '../../index';\nimport {\n  checkIsByMe,\n  isFineDelete,\n  isFineResend,\n  showMenuTrigger,\n} from '../../utils/openChannelUtils';\nimport { getSenderFromMessage } from '../../utils/openChannelUtils';\n\ninterface Props {\n  message: ClientFileMessage;\n  className?: string | string[];\n  userId: string;\n  disabled?: boolean;\n  chainTop?: boolean;\n  chainBottom?: boolean;\n  status: string;\n\n  showRemove(bool: boolean): void;\n  resendMessage(message: ClientFileMessage): void;\n}\n\nexport default function OpenchannelFileMessage({\n  message,\n  className,\n  userId,\n  disabled,\n  chainTop,\n  status,\n  showRemove,\n  resendMessage,\n}: Props): JSX.Element {\n  const contextMenuRef = useRef(null);\n  const avatarRef = useRef(null);\n  const { stringSet } = useContext(LocalizationContext);\n  const { disableUserProfile, renderUserProfile } = useContext(UserProfileContext);\n\n  const openFileUrl = () => { window.open(message.url); };\n\n  const injectingClassName = Array.isArray(className) ? className : [className];\n  injectingClassName.push('sendbird-openchannel-file-message');\n  const isByMe = checkIsByMe(message, userId);\n  const sender = getSenderFromMessage(message);\n\n  return (\n    <div\n      className={injectingClassName.join(' ')}\n    >\n      <div className=\"sendbird-openchannel-file-message__left\">\n        {\n            !chainTop && (\n              <ContextMenu\n                menuTrigger={(toggleDropdown) => (\n                  <Avatar\n                  className=\"sendbird-openchannel-file-message__left__avatar\"\n                    src={sender.profileUrl || ''}\n                    ref={avatarRef}\n                    width=\"28px\"\n                    height=\"28px\"\n                    onClick={() => {\n                      if (!disableUserProfile) {\n                        toggleDropdown();\n                      }\n                    }}\n                  />\n                )}\n                menuItems={(closeDropdown) => (\n                  <MenuItems\n                    parentRef={avatarRef}\n                    parentContainRef={avatarRef}\n                    closeDropdown={closeDropdown}\n                    style={{ paddingTop: 0, paddingBottom: 0 }}\n                  >\n                    {\n                      renderUserProfile\n                      ? (\n                        renderUserProfile({\n                          user: sender,\n                          close: closeDropdown,\n                        })\n                      )\n                      : (\n                        <UserProfile\n                          user={sender}\n                          onSuccess={closeDropdown}\n                          disableMessaging\n                        />\n                      )\n                    }\n                  </MenuItems>\n                )}\n              />\n            )\n          }\n      </div>\n      <div className=\"sendbird-openchannel-file-message__right\">\n        {\n          !chainTop && (\n            <div className=\"sendbird-openchannel-file-message__right__title\">\n              <Label\n                className=\"sendbird-openchannel-file-message__right__title__sender-name\"\n                type={LabelTypography.CAPTION_2}\n                color={isByMe ? LabelColors.SECONDARY_3 : LabelColors.ONBACKGROUND_2}\n              >\n                {\n                  sender && (\n                    sender.friendName\n                    || sender.nickname\n                    || sender.userId\n                  )\n                }\n              </Label>\n              <Label\n                className=\"sendbird-openchannel-file-message__right__title__sent-at\"\n                type={LabelTypography.CAPTION_3}\n                color={LabelColors.ONBACKGROUND_3}\n              >\n                {\n                  message.createdAt && (\n                    format(message.createdAt, 'p')\n                  )\n                }\n              </Label>\n            </div>\n          )\n        }\n        <div className=\"sendbird-openchannel-file-message__right__body\">\n          {\n            checkFileType(message.url) && (\n              <Icon\n                className=\"sendbird-openchannel-file-message__right__body__icon\"\n                width=\"48px\"\n                height=\"48px\"\n                type={checkFileType(message.url)}\n                color={IconColors.PRIMARY}\n              />\n            )\n          }\n          <TextButton\n            className=\"sendbird-openchannel-file-message__right__body__file-name\"\n            onClick={openFileUrl}\n          >\n            <Label\n              type={LabelTypography.BODY_1}\n              color={LabelColors.ONBACKGROUND_1}\n            >\n              {truncate(message.url, 40)}\n            </Label>\n          </TextButton>\n        </div>\n      </div>\n      <div\n        className=\"sendbird-openchannel-file-message__context-menu\"\n        ref={contextMenuRef}\n      >\n        {\n            <ContextMenu\n              menuTrigger={(toggleDropdown) => (\n                showMenuTrigger({ message, userId, status }) && (\n                  <IconButton\n                    className=\"sendbird-openchannel-file-message__context-menu__icon\"\n                    width=\"32px\"\n                    height=\"32px\"\n                    onClick={toggleDropdown}\n                  >\n                    <Icon\n                      type={IconTypes.MORE}\n                      width=\"24px\"\n                      height=\"24px\"\n                    />\n                  </IconButton>\n                )\n              )}\n              menuItems={(closeDropdown) => (\n                <MenuItems\n                  parentRef={contextMenuRef}\n                  parentContainRef={contextMenuRef}\n                  closeDropdown={closeDropdown}\n                  openLeft\n                >\n                  {\n                    isFineResend({ message, userId, status }) && (\n                      <MenuItem\n                        onClick={() => {\n                          if (disabled) { return; }\n                          resendMessage(message);\n                          closeDropdown();\n                        }}\n                      >\n                        {stringSet.CONTEXT_MENU_DROPDOWN__RESEND}\n                      </MenuItem>\n                    )\n                  }\n                  {\n                    isFineDelete({ message, userId, status }) && (\n                      <MenuItem\n                        onClick={() => {\n                          if (disabled) { return; }\n                          showRemove(true);\n                          closeDropdown();\n                        }}\n                      >\n                        {stringSet.CONTEXT_MENU_DROPDOWN__DELETE}\n                      </MenuItem>\n                    )\n                  }\n                </MenuItems>\n              )}\n            />\n        }\n      </div>\n    </div>\n  );\n}\n","import React, { useContext } from 'react'\nimport { ClientFileMessage, ClientUserMessage } from '../../..'\nimport Modal from '../../../ui/Modal';\nimport { LocalizationContext } from '../../../lib/LocalizationContext';\n\ninterface Props {\n  onCloseModal(): void;\n  onDeleteMessage(message: ClientUserMessage | ClientFileMessage, callback?: () => void): void;\n}\n\nexport default function RemoveMessageModal({\n  onCloseModal,\n  onDeleteMessage,\n}: Props): JSX.Element {\n  const { stringSet } = useContext(LocalizationContext);\n\n  return (\n    <Modal\n      onCancel={onCloseModal}\n      onSubmit={onDeleteMessage}\n      submitText=\"Delete\"\n      titleText={stringSet.MODAL__DELETE_MESSAGE__TITLE}\n    />\n  );\n}\n","import { EveryMessage } from '../../..';\nimport { isImage, isVideo } from '../../../ui/FileViewer/types';\n\nexport const MessageTypes = {\n  ADMIN: 'ADMIN',\n  USER: 'USER',\n  FILE: 'FILE',\n  THUMBNAIL: 'THUMBNAIL',\n  OG: 'OG',\n  UNKNOWN: 'UNKNOWN',\n};\n\nexport const SendingMessageStatus = {\n  NONE: 'none',\n  SUCCEEDED: 'succeeded',\n  FAILED: 'failed',\n  PENDING: 'pending',\n};\n\nexport const getMessageType = (message: EveryMessage): string => {\n  if ((message.isUserMessage && message.isUserMessage()) || message.messageType === 'user') {\n    return (message.ogMetaData)\n      ? MessageTypes.OG\n      : MessageTypes.USER;\n  }\n  if (message.isAdminMessage && message.isAdminMessage()) {\n    return MessageTypes.ADMIN;\n  }\n  if (message.messageType === 'file') {\n    return (isImage(message.type) || isVideo(message.type))\n      ? MessageTypes.THUMBNAIL\n      : MessageTypes.FILE;\n  }\n  return MessageTypes.UNKNOWN;\n};\n\nexport default {\n  MessageTypes,\n  SendingMessageStatus,\n  getMessageType,\n};\n","import React, {\n  useState,\n  useRef,\n  ReactElement,\n  useMemo,\n} from 'react';\n\nimport format from 'date-fns/format';\nimport {\n  ClientFileMessage,\n  ClientUserMessage,\n  EveryMessage,\n  RenderCustomMessage,\n} from '../../../index';\n\nimport OpenChannelUserMessage from '../../../ui/OpenchannelUserMessage';\nimport OpenChannelAdminMessage from '../../../ui/OpenChannelAdminMessage';\nimport OpenChannelOGMessage from '../../../ui/OpenchannelOGMessage';\nimport OpenChannelThumbnailMessage from '../../../ui/OpenchannelThumbnailMessage';\nimport OpenChannelFileMessage from '../../../ui/OpenchannelFileMessage';\n// import UnknownMessage from '../../../ui/UnknownMessage';\n\nimport DateSeparator from '../../../ui/DateSeparator';\nimport Label, { LabelTypography, LabelColors } from '../../../ui/Label';\nimport MessageInput from '../../../ui/MessageInput';\nimport FileViewer from '../../../ui/FileViewer';\n\nimport RemoveMessageModal from './RemoveMessageModal';\nimport {\n  MessageTypes,\n  SendingMessageStatus,\n  getMessageType,\n} from './types';\nimport { OpenChannel } from 'sendbird';\n\ninterface Props {\n  message: EveryMessage;\n  userId: string;\n  disabled: boolean;\n  editDisabled: boolean;\n  hasSeperator: boolean;\n  channel: OpenChannel;\n  renderCustomMessage?: RenderCustomMessage,\n  deleteMessage(message: ClientUserMessage | ClientFileMessage, callback?: () => void): void;\n  updateMessage(messageId: number, text: string, callback?: () => void): void;\n  resendMessage(failedMessage: ClientUserMessage | ClientFileMessage): void;\n  status?: string;\n  chainTop: boolean;\n  chainBottom: boolean;\n}\n\nexport default function MessageHoc({\n  message,\n  userId,\n  disabled,\n  editDisabled,\n  hasSeperator,\n  channel,\n  renderCustomMessage,\n  deleteMessage,\n  updateMessage,\n  resendMessage,\n  status,\n  chainTop,\n  chainBottom,\n}: Props): ReactElement {\n  let sender: SendBird.User = null;\n  if (message.messageType !== 'admin') {\n    sender = message.sender;\n  }\n\n  const RenderedMessage = useMemo(() => {\n    if (renderCustomMessage) {\n      return renderCustomMessage(message, channel);\n    }\n    return null;\n  }, [message, renderCustomMessage]);\n\n  const [showEdit, setShowEdit] = useState(false);\n  const [showRemove, setShowRemove] = useState(false);\n  const [showFileViewer, setShowFileViewer] = useState(false);\n  const editMessageInputRef = useRef(null);\n\n  let isByMe = false;\n\n  if (sender && message.messageType !== 'admin') {\n    // pending and failed messages are by me\n    isByMe = (userId === sender.userId)\n      || (message.requestState === SendingMessageStatus.PENDING)\n      || (message.requestState === SendingMessageStatus.FAILED);\n  }\n\n  if(RenderedMessage) {\n    return (\n      <div className=\"sendbird-msg-hoc sendbird-msg--scroll-ref\">\n        <RenderedMessage message={message} />\n      </div>\n    );\n  }\n\n  if (message.messageType === 'user' && showEdit) {\n    return (\n      <MessageInput\n        isEdit\n        disabled={editDisabled}\n        ref={editMessageInputRef}\n        name={message.messageId}\n        onSendMessage={updateMessage}\n        onCancelEdit={() => { setShowEdit(false); }}\n        value={message.message}\n      />\n    );\n  }\n\n  return (\n    <div className=\"sendbird-msg-hoc sendbird-msg--scroll-ref\">\n      {/* date-seperator */}\n      {\n        hasSeperator && (\n          <DateSeparator>\n            <Label type={LabelTypography.CAPTION_2} color={LabelColors.ONBACKGROUND_2}>\n              {format(message.createdAt, 'MMMM dd, yyyy')}\n            </Label>\n          </DateSeparator>\n        )\n      }\n      {/* Message */}\n      {\n        {\n          [MessageTypes.ADMIN]: (() => {\n            if (message.messageType === 'admin') {\n              return (\n                <OpenChannelAdminMessage message={message} />\n              )\n            }\n          })(),\n          [MessageTypes.FILE]: (() => {\n            if (message.messageType === 'file') {\n              return (\n                <OpenChannelFileMessage\n                  message={message}\n                  disabled={disabled}\n                  userId={userId}\n                  showRemove={setShowRemove}\n                  resendMessage={resendMessage}\n                  status={status}\n                  chainTop={chainTop}\n                  chainBottom={chainBottom}\n                />\n              );\n            }\n            return;\n          })(),\n          [MessageTypes.OG]: (() => {\n            if (message.messageType === 'user') {\n              return (\n                <OpenChannelOGMessage\n                  message={message}\n                  status={status}\n                  userId={userId}\n                  showEdit={setShowEdit}\n                  disabled={disabled}\n                  showRemove={setShowRemove}\n                  resendMessage={resendMessage}\n                  chainTop={chainTop}\n                  chainBottom={chainBottom}\n                />\n              );\n            }\n            return;\n          })(),\n          [MessageTypes.THUMBNAIL]: (() => {\n            if (message.messageType === 'file') {\n              return (\n                <OpenChannelThumbnailMessage\n                  message={message}\n                  disabled={disabled}\n                  userId={userId}\n                  showRemove={setShowRemove}\n                  resendMessage={resendMessage}\n                  onClick={setShowFileViewer}\n                  status={status}\n                  chainTop={chainTop}\n                  chainBottom={chainBottom}\n                />\n              );\n            }\n            return;\n          })(),\n          [MessageTypes.USER]: (() => {\n            if (message.messageType === 'user') {\n              return (\n                <OpenChannelUserMessage\n                  message={message}\n                  userId={userId}\n                  disabled={disabled}\n                  showEdit={setShowEdit}\n                  showRemove={setShowRemove}\n                  resendMessage={resendMessage}\n                  status={status}\n                  chainTop={chainTop}\n                  chainBottom={chainBottom}\n                />\n              );\n            }\n            return;\n          })(),\n          [MessageTypes.UNKNOWN]: (() => {\n            return;\n            // return (\n            //   <OpenChannelUnknownMessage message={message} />\n            // );\n          })(),\n        }[getMessageType(message)]\n      }\n      {/* Modal */}\n      {\n        showRemove && (\n          <RemoveMessageModal\n            onCloseModal={() => setShowRemove(false)}\n            onDeleteMessage={() => {\n              if (message.messageType !== 'admin') {\n                deleteMessage(message);\n              }\n            }}\n          />\n        )\n      }\n      {\n        showFileViewer && (\n          <FileViewer\n            onClose={() => setShowFileViewer(false)}\n            message={message}\n            onDelete={deleteMessage}\n            isByMe={isByMe}\n          />\n        )\n      }\n      {/* {\n        !((message.isFileMessage && message.isFileMessage()) || message.messageType === 'file')\n        && !(message.isAdminMessage && message.isAdminMessage())\n        && !(((message.isUserMessage && message.isUserMessage()) || message.messageType === 'user'))\n        && !(showFileViewer)\n        && (\n          <UnknownMessage\n            message={message}\n            status={status}\n            isByMe={isByMe}\n            showRemove={setShowRemove}\n            chainTop={chainTop}\n            chainBottom={chainBottom}\n          />\n        )\n      } */}\n    </div>\n  );\n}\n","import React, { ReactElement, useRef, useEffect } from 'react';\nimport isSameDay from 'date-fns/isSameDay';\nimport {\n  ClientFileMessage,\n  ClientUserMessage,\n  EveryMessage,\n  RenderCustomMessage,\n} from '../../../index';\nimport MessageHoc from './MessageHOC';\n\nimport './openchannel-conversation-scroll.scss';\nimport { compareMessagesForGrouping } from '../utils';\n\ninterface Props {\n  openchannel: SendBird.OpenChannel;\n  user: SendBird.User;\n  allMessages: EveryMessage[];\n  useMessageGrouping: boolean;\n  isOnline: boolean;\n  hasMore: boolean;\n  renderCustomMessage?: RenderCustomMessage;\n  onScroll(callback?: () => void): void;\n  scrollDownPromise: PromiseLike<void>;\n  showScrollDownButton?(bool: boolean): void;\n  updateMessage(messageId: number, text: string, callback?: () => void ): void;\n  deleteMessage(message: ClientUserMessage | ClientFileMessage, callback?: () => void ): void;\n  resendMessage(failedMessage: ClientUserMessage | ClientFileMessage): void;\n}\n\nexport default function OpenchannelConversationScroll(\n  {\n    useMessageGrouping = true,\n    openchannel,\n    user,\n    allMessages,\n    isOnline = true,\n    hasMore,\n    onScroll,\n    scrollDownPromise,\n    renderCustomMessage,\n    showScrollDownButton,\n    updateMessage,\n    deleteMessage,\n    resendMessage,\n  }: Props\n): ReactElement {\n  const scrollRef = useRef(null);\n\n  const handleOnScroll = (e) => {\n    const element = e.target;\n    const {\n      scrollTop,\n      scrollHeight,\n      clientHeight,\n    } = element;\n    if (showScrollDownButton) {\n      if (scrollHeight > scrollTop + clientHeight) {\n        showScrollDownButton(true);\n      } else {\n        showScrollDownButton(false);\n      }\n    }\n\n    if (scrollTop === 0) {\n      if (!hasMore) {\n        return;\n      }\n      const nodes = scrollRef.current.querySelectorAll('.sendbird-msg--scroll-ref');\n      onScroll(() => {\n        const first = nodes[0];\n        first.scrollIntoView();\n      });\n    }\n  };\n\n  useEffect(() => {\n    // This promise is created in everytime when user click the scroll to bottom button\n    // This scope waits when user click the button and scrolls to the bottom of conversation\n    if (scrollDownPromise && scrollRef && scrollRef.current) {\n      scrollDownPromise.then(() => {\n        scrollRef.current.scrollTo(0, scrollRef.current.scrollHeight);\n        if (showScrollDownButton) {\n          showScrollDownButton(false);\n        }\n      });\n    }\n    return;\n  }, [scrollDownPromise]);\n\n  return (\n    <div\n      className=\"sendbird-openchannel-conversation-scroll\"\n      onScroll={handleOnScroll}\n      ref={scrollRef}\n    >\n      <div className=\"sendbird-openchannel-conversation-scroll__container\">\n        <div className=\"sendbird-openchannel-conversation-scroll__container__padding\" />\n        <div className=\"sendbird-openchannel-conversation-scroll__container__item-container\">\n          {\n            allMessages.map((message, index) => {\n              let status: string;\n\n              if (message.messageType !== 'admin') {\n                status = message.sendingStatus;\n              }\n\n              const previousMessage = allMessages[index - 1];\n              const nextMessage = allMessages[index - 1];\n\n              const previousMessageCreatedAt = previousMessage && previousMessage.createdAt;\n              const currentCreatedAt = message.createdAt;\n              // https://stackoverflow.com/a/41855608\n              const hasSeperator = !(previousMessageCreatedAt && (\n                isSameDay(currentCreatedAt, previousMessageCreatedAt)\n              ));\n\n              const [chainTop, chainBottom] = useMessageGrouping\n                ? compareMessagesForGrouping(previousMessage, message, nextMessage)\n                : [false, false];\n              return (\n                <MessageHoc\n                  renderCustomMessage={renderCustomMessage}\n                  channel={openchannel}\n                  key={message.messageId}\n                  message={message}\n                  status={status}\n                  userId={user.userId}\n                  disabled={!isOnline}\n                  editDisabled={openchannel.isFrozen}\n                  hasSeperator={hasSeperator}\n                  chainTop={chainTop}\n                  chainBottom={chainBottom}\n                  deleteMessage={deleteMessage}\n                  updateMessage={updateMessage}\n                  resendMessage={resendMessage}\n                />\n              )\n            })\n          }\n        </div>\n      </div>\n    </div>\n  );\n}\n","export const SET_CURRENT_CHANNEL = 'SET_CURRENT_CHANNEL';\nexport const SET_CHANNEL_INVALID = 'SET_CHANNEL_INVALID';\nexport const RESET_MESSAGES = 'RESET_MESSAGES';\nexport const GET_PREV_MESSAGES_SUCESS = 'GET_PREV_MESSAGES_SUCESS';\nexport const GET_PREV_MESSAGES_FAIL = 'GET_PREV_MESSAGES_FAIL';\nexport const SENDING_MESSAGE_FAILED = 'SENDING_MESSAGE_FAILED';\nexport const SENDING_MESSAGE_SUCCEEDED = 'SENDING_MESSAGE_SUCCEEDED';\nexport const SENDING_MESSAGE_START = 'SENDING_MESSAGE_START';\nexport const RESENDING_MESSAGE_START = 'RESENDING_MESSAGE_START';\n\n// event handlers\nexport const ON_MESSAGE_RECEIVED = 'ON_MESSAGE_RECEIVED';\nexport const ON_MESSAGE_UPDATED = 'ON_MESSAGE_UPDATED';\nexport const ON_MESSAGE_DELETED = 'ON_MESSAGE_DELETED';\nexport const ON_MESSAGE_DELETED_BY_REQ_ID = 'ON_MESSAGE_DELETED_BY_REQ_ID';\nexport const ON_OPERATOR_UPDATED = 'ON_OPERATOR_UPDATED';\nexport const ON_USER_ENTERED = 'ON_USER_ENTERED';\nexport const ON_USER_EXITED = 'ON_USER_EXITED';\nexport const ON_USER_MUTED = 'ON_USER_MUTED';\nexport const ON_USER_UNMUTED = 'ON_USER_UNMUTED';\nexport const ON_USER_BANNED = 'ON_USER_BANNED';\nexport const ON_USER_UNBANNED = 'ON_USER_UNBANNED';\nexport const ON_CHANNEL_FROZEN = 'ON_CHANNEL_FROZEN';\nexport const ON_CHANNEL_UNFROZEN = 'ON_CHANNEL_UNFROZEN';\nexport const ON_CHANNEL_CHANGED = 'ON_CHANNEL_CHANGED';\nexport const ON_META_DATA_CREATED = 'ON_META_DATA_CREATED';\nexport const ON_META_DATA_UPDATED = 'ON_META_DATA_UPDATED';\nexport const ON_META_DATA_DELETED = 'ON_META_DATA_DELETED';\nexport const ON_META_COUNTERS_CREATED = 'ON_META_COUNTERS_CREATED';\nexport const ON_META_COUNTERS_UPDATED = 'ON_META_COUNTERS_UPDATED';\nexport const ON_META_COUNTERS_DELETED = 'ON_META_COUNTERS_DELETED';\nexport const ON_MENTION_RECEIVED = 'ON_MENTION_RECEIVED';\n","import { State as initialStateInterface } from './initialState';\nimport * as actionTypes from './actionTypes';\n\nimport compareIds from '../../../utils/compareIds.js';\n\n/* eslint-disable  @typescript-eslint/no-explicit-any */\n// @ts-ignore: Unreachable code error\ninterface ActionInterface {\n  type: string;\n  payload?: any;\n}\n\nexport default function reducer(\n  state: initialStateInterface,\n  action: ActionInterface,\n): initialStateInterface {\n  switch (action.type) {\n    case actionTypes.RESET_MESSAGES: {\n      return {\n        ...state,\n        allMessages: [],\n      };\n    }\n\n    case actionTypes.SET_CURRENT_CHANNEL: {\n      const currentChannel = action.payload;\n      const operators = currentChannel.operators;\n      if (\n        !state.isInvalid\n        && state.currentOpenChannel\n        && state.currentOpenChannel.url\n        && (state.currentOpenChannel.url === currentChannel.url)\n      ) {\n        return state;\n      }\n      return {\n        ...state,\n        currentOpenChannel: currentChannel,\n        isInvalid: false,\n        operators: operators,\n        participants: operators,\n      };\n    }\n    case actionTypes.SET_CHANNEL_INVALID: {\n      return {\n        ...state,\n        isInvalid: true,\n      };\n    }\n    case actionTypes.GET_PREV_MESSAGES_SUCESS:\n    case actionTypes.GET_PREV_MESSAGES_FAIL: {\n      const isFailed = (action.type === actionTypes.GET_PREV_MESSAGES_FAIL);\n      const {\n        currentOpenChannel = {},\n        messages = [],\n        hasMore,\n        lastMessageTimestamp,\n      } = action.payload;\n      const actionChannelUrl = currentOpenChannel.url;\n      const receivedMessages = isFailed ? [] : messages;\n      const _hasMore = isFailed ? false : hasMore;\n      const _lastMessageTimestamp = isFailed ? 0 : lastMessageTimestamp;\n\n      const stateChannel = state.currentOpenChannel;\n      const stateChannelUrl = stateChannel.url;\n\n      if (actionChannelUrl !== stateChannelUrl) {\n        return state;\n      }\n\n      const filteredAllMessages = state.allMessages.filter((message) => (\n        !(receivedMessages.find(({ messageId }) => compareIds(messageId, message.messageId)))\n      ));\n      return {\n        ...state,\n        loading: false,\n        initialized: true,\n        hasMore: _hasMore,\n        lastMessageTimestamp: _lastMessageTimestamp,\n        allMessages: [\n          ...receivedMessages,\n          ...filteredAllMessages,\n        ],\n      };\n    }\n    case actionTypes.SENDING_MESSAGE_START: {\n      const {\n        message,\n        channel,\n      } = action.payload;\n      if (channel.url !== state.currentOpenChannel.url) {\n        return state;\n      }\n      return {\n        ...state,\n        allMessages: [\n          ...state.allMessages,\n          { ...message },\n        ],\n      };\n    }\n    case actionTypes.SENDING_MESSAGE_SUCCEEDED: {\n      const sentMessage = action.payload;\n      const newMessages = state.allMessages.map((m) => (\n        compareIds(m.reqId, sentMessage.reqId) ? sentMessage : m\n      ));\n      return {\n        ...state,\n        allMessages: newMessages,\n      };\n    }\n    case actionTypes.SENDING_MESSAGE_FAILED: {\n      const sentMessage = action.payload;\n      return {\n        ...state,\n        allMessages: state.allMessages.map((m) => (\n          compareIds(m.reqId, sentMessage.reqId) ? sentMessage : m\n        )),\n      };\n    }\n    case actionTypes.RESENDING_MESSAGE_START: {\n      const eventedChannel = action.payload.channel;\n      const resentMessage = action.payload.message;\n      if (eventedChannel.url !== state.currentOpenChannel.url) {\n        return state;\n      }\n      return {\n        ...state,\n        allMessages: state.allMessages.map((m) => (\n          compareIds(m.reqId, resentMessage.reqId) ? resentMessage : m\n        )),\n      };\n    }\n    case actionTypes.ON_MESSAGE_RECEIVED: {\n      const eventedChannel = action.payload.channel;\n      const receivedMessage = action.payload.message;\n      const {\n        currentOpenChannel\n      } = state;\n\n      if (\n        !compareIds(eventedChannel.url, currentOpenChannel.url)\n        || (\n          !(state.allMessages.map(\n            (message) => message.messageId).indexOf(receivedMessage.messageId) < 0\n        ))\n      ) {\n        return state;\n      }\n\n      return {\n        ...state,\n        allMessages: [...state.allMessages, receivedMessage],\n      };\n    }\n    case actionTypes.ON_MESSAGE_UPDATED: {\n      const eventedChannel = action.payload.channel;\n      const updatedMessage = action.payload.message;\n      const currentChannel = state.currentOpenChannel;\n      if (!currentChannel || currentChannel.url && (currentChannel.url !== eventedChannel.url)) {\n        return state;\n      }\n      return {\n        ...state,\n        allMessages: state.allMessages.map((message) => (\n          message.isIdentical(updatedMessage)\n            ? updatedMessage\n            : message\n        )),\n      };\n    }\n    case actionTypes.ON_MESSAGE_DELETED: {\n      const eventedChannel = action.payload.channel;\n      const deletedMessageId = action.payload.messageId;\n      const currentChannel = state.currentOpenChannel;\n      if (!currentChannel || currentChannel.url && (currentChannel.url !== eventedChannel.url)) {\n        return state;\n      }\n      return {\n        ...state,\n        allMessages: state.allMessages.filter((message) => (\n          !compareIds(message.messageId, deletedMessageId)\n        )),\n      };\n    }\n    case actionTypes.ON_MESSAGE_DELETED_BY_REQ_ID: {\n      return {\n        ...state,\n        allMessages: state.allMessages.filter((m) => (\n          !compareIds(m.reqId, action.payload)\n        )),\n      };\n    }\n    case actionTypes.ON_OPERATOR_UPDATED: {\n      const eventedChannel = action.payload.channel;\n      const updatedOperators = action.payload.operators;\n      const currentChannel = state.currentOpenChannel;\n      if (!currentChannel || currentChannel.url && (currentChannel.url !== eventedChannel.url)) {\n        return state;\n      }\n      return {\n        ...state,\n        currentOpenChannel: {\n          ...state.currentOpenChannel,\n          operators: updatedOperators,\n        },\n        operators: updatedOperators,\n      };\n    }\n    case actionTypes.ON_USER_ENTERED: {\n      const eventedChannel = action.payload.channel;\n      const enteredUser = action.payload.user;\n      const currentChannel = state.currentOpenChannel;\n      if (!currentChannel || currentChannel.url && (currentChannel.url !== eventedChannel.url)) {\n        return state;\n      }\n      return {\n        ...state,\n        participants: [...state.participants, enteredUser],\n      };\n    }\n    case actionTypes.ON_USER_EXITED: {\n      const eventedChannel = action.payload.channel;\n      const exitedUser = action.payload.user;\n      const currentChannel = state.currentOpenChannel;\n      if (!currentChannel || currentChannel.url && (currentChannel.url !== eventedChannel.url)) {\n        return state;\n      }\n      return {\n        ...state,\n        participants: state.participants.filter((participant) => (\n          !compareIds(participant.userId, exitedUser.userId)\n        )),\n      };\n    }\n    case actionTypes.ON_USER_MUTED: {\n      // const eventedChannel = action.payload.channel;\n      // const mutedUser = action.payload.user;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    case actionTypes.ON_USER_UNMUTED: {\n      // const eventedChannel = action.payload.channel;\n      // const unmutedUser = action.payload.user;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    case actionTypes.ON_USER_BANNED: {\n      // const eventedChannel = action.payload.channel;\n      // const bannedUser = action.payload.user;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    case actionTypes.ON_USER_UNBANNED: {\n      // const eventedChannel = action.payload.channel;\n      // const unbannedUser = action.payload.user;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    case actionTypes.ON_CHANNEL_FROZEN: {\n      const frozenChannel = action.payload;\n      const currentChannel = state.currentOpenChannel;\n      if (!currentChannel || currentChannel.url && (currentChannel.url !== frozenChannel.url)) {\n        return state;\n      }\n      return {\n        ...state,\n        frozen: true,\n      };\n    }\n    case actionTypes.ON_CHANNEL_UNFROZEN: {\n      const unfrozenChannel = action.payload;\n      const currentChannel = state.currentOpenChannel;\n      if (!currentChannel || currentChannel.url && (currentChannel.url !== unfrozenChannel.url)) {\n        return state;\n      }\n      return {\n        ...state,\n        frozen: false,\n      };\n    }\n    case actionTypes.ON_CHANNEL_CHANGED: {\n      const changedChannel = action.payload;\n      const currentChannel = state.currentOpenChannel;\n      if (!currentChannel || currentChannel.url && (currentChannel.url !== changedChannel.url)) {\n        return state;\n      }\n      return {\n        ...state,\n        currentOpenChannel: changedChannel,\n      };\n    }\n    case actionTypes.ON_META_DATA_CREATED: {\n      // const eventedChannel = action.payload.channel;\n      // const createdMetaData = action.payload.metaData;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    case actionTypes.ON_META_DATA_UPDATED: {\n      // const eventedChannel = action.payload.channel;\n      // const updatedMetaData = action.payload.metaData;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    case actionTypes.ON_META_DATA_DELETED: {\n      // const eventedChannel = action.payload.channel;\n      // const deletedMetaDataKeys = action.payload.metaDataKeys;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    case actionTypes.ON_META_COUNTERS_CREATED: {\n      // const eventedChannel = action.payload.channel;\n      // const createdMetaCounter = action.payload.metaCounter;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    case actionTypes.ON_META_COUNTERS_UPDATED: {\n      // const eventedChannel = action.payload.channel;\n      // const updatedMetaCounter = action.payload.metaCounter;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    case actionTypes.ON_META_COUNTERS_DELETED: {\n      // const eventedChannel = action.payload.channel;\n      // const deletedMetaCounterKeys = action.payload.metaCounterKeys;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    case actionTypes.ON_MENTION_RECEIVED: {\n      // const eventedChannel = action.payload.channel;\n      // const mentionedMessage = action.payload.message;\n      // return {\n      //   ...state\n      // };\n      return state;\n    }\n    default:\n      return state;\n  }\n}\n","import Sendbird from 'sendbird';\nimport { EveryMessage } from '../../../index';\n\nexport interface State {\n  allMessages: EveryMessage[];\n  loading: boolean;\n  initialized: boolean;\n  currentOpenChannel: Sendbird.OpenChannel;\n  isInvalid: boolean;\n  hasMore: boolean;\n  lastMessageTimestamp: number;\n  frozen: boolean;\n  operators: Sendbird.User[];\n  participants: Sendbird.User[];\n  // add banned participant ids\n  // add muted participant ids\n}\n\nconst initialState: State = {\n  allMessages: [],\n  loading: false,\n  initialized: false,\n  currentOpenChannel: null,\n  isInvalid: false,\n  hasMore: false,\n  lastMessageTimestamp: 0,\n  frozen: false,\n  operators: [],\n  participants: [],\n  // bannedParticipantIds\n  // mutedParticipantIds\n};\n\nexport default initialState;\n","import React, {\n  useRef,\n  useCallback,\n  useEffect,\n  useReducer,\n  useContext,\n  useState,\n  ReactElement,\n} from 'react';\nimport Sendbird from 'sendbird';\nimport * as utils from './utils';\nimport './index.scss';\n\nimport MessageInputWrapper from './components/MessageInpuetWrapper';\nimport FrozenChannelNotification from './components/FrozenNotification';\nimport OpenchannelConversationHeader from '../../ui/OpenchannelConversationHeader';\nimport OpenchannelConversationScroll from './components/OpenchannelConversationScroll';\nimport Icon, { IconColors, IconTypes } from '../../ui/Icon';\nimport PlaceHolder, { PlaceHolderTypes } from '../../ui/PlaceHolder';\nimport { UserProfileProvider } from '../../lib/UserProfileContext';\n\nimport {\n  EveryMessage,\n  ClientUserMessage,\n  ClientFileMessage,\n  OpenChannelProps,\n} from '../../index';\nimport messagesReducer from './dux/reducers';\nimport messagesInitialState from './dux/initialState';\nimport * as messageActionTypes from './dux/actionTypes';\nimport withSendbirdContext from '../../lib/SendbirdSdkContext.jsx';\nimport { LocalizationContext } from '../../lib/LocalizationContext';\nimport { scrollIntoLast } from './utils';\nimport * as topics from '../../lib/pubSub/topics';\nimport uuidv4 from '../../utils/uuid';\n\nconst COMPONENT_CLASS_NAME = 'sendbird-openchannel-conversation';\n\ninterface Props extends OpenChannelProps {\n  stores: {\n    sdkStore?: SendbirdUIKit.SdkStore,\n    userStore?: {\n      user: Sendbird.User,\n    },\n  };\n  config: {\n    userId: string,\n    isOnline: boolean,\n    logger?: SendbirdUIKit.Logger,\n    theme?: string,\n    // @ts-ignore: Unreachable code error\n    pubSub: any;\n    disableUserProfile?: boolean;\n    renderUserProfile?(): JSX.Element;\n  };\n}\n\nexport const OpenchannelConversation = (props: Props): JSX.Element => {\n  // props\n  const {\n    useMessageGrouping,\n    channelUrl,\n    stores,\n    config,\n    queries = {},\n    disableUserProfile,\n    renderCustomMessage,\n    renderUserProfile,\n    renderChannelTitle,\n    renderMessageInput,\n    onBeforeSendUserMessage,\n    onBeforeSendFileMessage,\n    onChatHeaderActionClick\n  } = props;\n\n  const {\n    sdkStore,\n    userStore,\n  } = stores;\n  const {\n    userId,\n    isOnline,\n    logger,\n    pubSub,\n  } = config;\n\n  const {\n    sdk\n  } = sdkStore;\n  const {\n    user\n  } = userStore;\n\n  // hook variables\n  const [messagesStore, messagesDispatcher] = useReducer(messagesReducer, messagesInitialState);\n  const {\n    allMessages,\n    loading,\n    initialized,\n    currentOpenChannel,\n    isInvalid,\n    hasMore,\n    lastMessageTimestamp,\n  } = messagesStore;\n  // ref\n  const messageInputRef = useRef(null); // useSendMessageCallback\n  const { stringSet } = useContext(LocalizationContext);\n  const [scrollDownPromise, setScrollDownPromise] = useState(null);\n  const [showScrollDownButton, setShowScrollDownButton] = useState(false);\n\n  // const\n  const sdkInit = sdkStore.initialized;\n  const userFilledMessageListParams = queries ? queries.messageListParams: null;\n  const disabled = !initialized\n    || !isOnline\n    || utils.isDisabledBecauseFrozen(currentOpenChannel, userId);\n  // || utils.isDisabledBecauseMuted(mutedParticipantIds, userId)\n  const userDefinedDisableUserProfile = disableUserProfile || config.disableUserProfile;\n  const userDefinedRenderProfile = renderUserProfile || config.renderUserProfile;\n\n  // useSetChannel\n  useEffect(() => {\n    if (channelUrl && sdkInit && sdk && sdk.OpenChannel) {\n      logger.info('OpenChannel | useSetChannel fetching channel', channelUrl);\n      sdk.OpenChannel.getChannel(channelUrl, (openChannel, error) => {\n        if (!error) {\n          logger.info('OpenChannel | useSetChannel fetched channel', openChannel);\n          messagesDispatcher({\n            type: messageActionTypes.SET_CURRENT_CHANNEL,\n            payload: openChannel,\n          });\n          openChannel.enter((error) => {\n            if (error) {\n              logger.warning('OpenChannel | useSetChannel enter channel failed', { channelUrl, error });\n              messagesDispatcher({\n                type: messageActionTypes.SET_CHANNEL_INVALID,\n              });\n            }\n          });\n        } else {\n          logger.warning('OpenChannel | useSetChannel fetch channel failed', { channelUrl, error });\n          messagesDispatcher({\n            type: messageActionTypes.SET_CHANNEL_INVALID,\n          });\n        }\n      });\n      // .then((openChannel) => {\n      //   logger.info('OpenChannel | useSetChannel fetched channel', openChannel);\n      //   messagesDispatcher({\n      //     type: messageActionTypes.SET_CURRENT_CHANNEL,\n      //     payload: openChannel,\n      //   });\n      // })\n      // .catch((error) => {\n      //   logger.warning('OpenChannel | useSetChannel fetch channel failed', { channelUrl, error });\n      //   messagesDispatcher({\n      //     type: messageActionTypes.SET_CHANNEL_INVALID,\n      //   });\n      // });\n    }\n  }, [channelUrl, sdkInit]);\n\n  // handles API calls from withSendbird\n  useEffect(() => {\n    const subscriber = new Map();\n    if (!pubSub || !pubSub.subscribe) {\n      return;\n    }\n    subscriber.set(topics.SEND_USER_MESSAGE, pubSub.subscribe(topics.SEND_USER_MESSAGE, (msg) => {\n      const { channel, message } = msg;\n      scrollIntoLast('.sendbird-msg--scroll-ref');\n      if (channel && (channelUrl === channel.url)) {\n        messagesDispatcher({\n          type: messageActionTypes.SENDING_MESSAGE_SUCCEEDED,\n          payload: message,\n        });\n      }\n    }));\n    subscriber.set(topics.SEND_MESSAGE_START, pubSub.subscribe(topics.SEND_MESSAGE_START, (msg) => {\n      const { channel, message } = msg;\n      if (channel && (channelUrl === channel.url)) {\n        messagesDispatcher({\n          type: messageActionTypes.SENDING_MESSAGE_START,\n          payload: message,\n        });\n      }\n    }));\n    subscriber.set(topics.SEND_FILE_MESSAGE, pubSub.subscribe(topics.SEND_FILE_MESSAGE, (msg) => {\n      const { channel, message } = msg;\n      scrollIntoLast('.sendbird-msg--scroll-ref');\n      if (channel && (channelUrl === channel.url)) {\n        messagesDispatcher({\n          type: messageActionTypes.SENDING_MESSAGE_SUCCEEDED,\n          payload: message,\n        });\n      }\n    }));\n    subscriber.set(topics.UPDATE_USER_MESSAGE, pubSub.subscribe(topics.UPDATE_USER_MESSAGE, (msg) => {\n      const { channel, message, fromSelector } = msg;\n      if (fromSelector && channel && (channelUrl === channel.url)) {\n        messagesDispatcher({\n          type: messageActionTypes.ON_MESSAGE_UPDATED,\n          payload: { channel, message },\n        });\n      }\n    }));\n    subscriber.set(topics.DELETE_MESSAGE, pubSub.subscribe(topics.DELETE_MESSAGE, (msg) => {\n      const { channel, messageId } = msg;\n      if (channel && (channelUrl === channel.url)) {\n        messagesDispatcher({\n          type: messageActionTypes.ON_MESSAGE_DELETED,\n          payload: messageId,\n        });\n      }\n    }));\n\n    return () => {\n      if (subscriber) {\n        subscriber.forEach((s) => {\n          try {\n            s.remove();\n          } catch {\n            //\n          }\n        });\n      }\n    };\n  }, [channelUrl, sdkInit]);\n\n  // useHandleChannelEvents\n  useEffect(() => {\n    const messageReceiverId = uuidv4();\n    if (currentOpenChannel && currentOpenChannel.url && sdk && sdk.ChannelHandler) {\n      const ChannelHandler = new sdk.ChannelHandler();\n      logger.info('OpenChannel | useHandleChannelEvents: Setup event handler', messageReceiverId);\n\n      ChannelHandler.onMessageReceived = (channel, message) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onMessageReceived', { channelUrl, message });\n        messagesDispatcher({\n          type: messageActionTypes.ON_MESSAGE_RECEIVED,\n          payload: { channel, message },\n        });\n      };\n      ChannelHandler.onMessageUpdated = (channel, message) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onMessageUpdated', { channelUrl, message });\n        messagesDispatcher({\n          type: messageActionTypes.ON_MESSAGE_UPDATED,\n          payload: { channel, message },\n        });\n      };\n      ChannelHandler.onMessageDeleted = (channel, messageId) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onMessageDeleted', { channelUrl, messageId });\n        messagesDispatcher({\n          type: messageActionTypes.ON_MESSAGE_DELETED,\n          payload: { channel, messageId },\n        });\n      };\n      ChannelHandler.onOperatorUpdated = (channel, operators) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onOperatorUpdated', { channelUrl, operators });\n        messagesDispatcher({\n          type: messageActionTypes.ON_OPERATOR_UPDATED,\n          payload: { channel, operators },\n        });\n      };\n      ChannelHandler.onUserEntered = (channel, user) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onUserEntered', { channelUrl, user });\n        messagesDispatcher({\n          type: messageActionTypes.ON_USER_ENTERED,\n          payload: { channel, user },\n        });\n      };\n      ChannelHandler.onUserExited = (channel, user) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onUserExited', { channelUrl, user });\n        messagesDispatcher({\n          type: messageActionTypes.ON_USER_EXITED,\n          payload: { channel, user },\n        });\n      };\n      ChannelHandler.onUserMuted = (channel, user) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onUserMuted', { channelUrl, user });\n        messagesDispatcher({\n          type: messageActionTypes.ON_USER_MUTED,\n          payload: { channel, user },\n        });\n      };\n      ChannelHandler.onUserUnmuted = (channel, user) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onUserUnmuted', { channelUrl, user });\n        messagesDispatcher({\n          type: messageActionTypes.ON_USER_UNMUTED,\n          payload: { channel, user },\n        });\n      };\n      ChannelHandler.onUserBanned = (channel, user) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onUserBanned', { channelUrl, user });\n        messagesDispatcher({\n          type: messageActionTypes.ON_USER_BANNED,\n          payload: { channel, user },\n        });\n      };\n      ChannelHandler.onUserUnbanned = (channel, user) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onUserUnbanned', { channelUrl, user });\n        messagesDispatcher({\n          type: messageActionTypes.ON_USER_UNBANNED,\n          payload: { channel, user },\n        });\n      };\n      ChannelHandler.onChannelFrozen = (channel) => {\n        logger.info('OpenChannel | useHandleChannelEvents: onChannelFrozen', channel);\n        messagesDispatcher({\n          type: messageActionTypes.ON_CHANNEL_FROZEN,\n          payload: channel,\n        });\n      };\n      ChannelHandler.onChannelUnfrozen = (channel) => {\n        logger.info('OpenChannel | useHandleChannelEvents: onChannelUnfrozen', channel);\n        messagesDispatcher({\n          type: messageActionTypes.ON_CHANNEL_UNFROZEN,\n          payload: channel,\n        });\n      };\n      ChannelHandler.onChannelChanged = (channel) => {\n        logger.info('OpenChannel | useHandleChannelEvents: onChannelChanged', channel);\n        messagesDispatcher({\n          type: messageActionTypes.ON_CHANNEL_CHANGED,\n          payload: channel,\n        });\n      };\n      ChannelHandler.onMetaDataCreated = (channel, metaData) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onMetaDataCreated', { channelUrl, metaData });\n        messagesDispatcher({\n          type: messageActionTypes.ON_META_DATA_CREATED,\n          payload: { channel, metaData },\n        });\n      };\n      ChannelHandler.onMetaDataUpdated = (channel, metaData) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onMetaDataUpdated', { channelUrl, metaData });\n        messagesDispatcher({\n          type: messageActionTypes.ON_META_DATA_UPDATED,\n          payload: { channel, metaData },\n        });\n      };\n      ChannelHandler.onMetaDataDeleted = (channel, metaDataKeys) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onMetaDataDeleted', { channelUrl, metaDataKeys });\n        messagesDispatcher({\n          type: messageActionTypes.ON_META_DATA_DELETED,\n          payload: { channel, metaDataKeys },\n        });\n      };\n      ChannelHandler.onMetaCountersCreated = (channel, metaCounter) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onMetaCountersCreated', { channelUrl, metaCounter });\n        messagesDispatcher({\n          type: messageActionTypes.ON_META_COUNTERS_CREATED,\n          payload: { channel, metaCounter },\n        });\n      };\n      ChannelHandler.onMetaCountersUpdated = (channel, metaCounter) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onMetaCountersUpdated', { channelUrl, metaCounter });\n        messagesDispatcher({\n          type: messageActionTypes.ON_META_COUNTERS_UPDATED,\n          payload: { channel, metaCounter },\n        });\n      };\n      ChannelHandler.onMetaCountersDeleted = (channel, metaCounterKeys) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onMetaCountersDeleted', { channelUrl, metaCounterKeys });\n        messagesDispatcher({\n          type: messageActionTypes.ON_META_COUNTERS_DELETED,\n          payload: { channel, metaCounterKeys },\n        });\n      };\n      ChannelHandler.onMentionReceived = (channel, message) => {\n        const channelUrl = channel.url;\n        logger.info('OpenChannel | useHandleChannelEvents: onMentionReceived', { channelUrl, message });\n        messagesDispatcher({\n          type: messageActionTypes.ON_MENTION_RECEIVED,\n          payload: { channel, message },\n        });\n      };\n      sdk.addChannelHandler(messageReceiverId, ChannelHandler);\n    }\n\n    return () => {\n      if (sdk && sdk.removeChannelHandler) {\n        logger.info('OpenChannel | useHandleChannelEvents: Removing message receiver handler', messageReceiverId);\n        sdk.removeChannelHandler(messageReceiverId);\n      }\n    };\n  }, [currentOpenChannel]);\n\n  // useInitialMessagesFetch\n  useEffect(() => {\n    logger.info('OpenChannel | useInitialMessagesFetch: Setup started', currentOpenChannel);\n\n    messagesDispatcher({\n      type: messageActionTypes.RESET_MESSAGES,\n    });\n\n    if (sdk && sdk.MessageListParams && currentOpenChannel && currentOpenChannel.getMessagesByTimestamp) {\n      const messageListParams = new sdk.MessageListParams();\n      messageListParams.prevResultSize = 30;\n      messageListParams.isInclusive = true;\n      messageListParams.includeReplies = false;\n      messageListParams.includeReactions = false;\n      if (userFilledMessageListParams) {\n        Object.keys(userFilledMessageListParams).forEach(key => {\n          messageListParams[key] = userFilledMessageListParams[key];\n        });\n        logger.info('OpenChannel | Used customizedMessageListParams');\n      }\n\n      logger.info('OpenChannel | Fetching messages', { currentOpenChannel, messageListParams });\n\n      currentOpenChannel.getMessagesByTimestamp(\n        new Date().getTime(),\n        messageListParams,\n        (messages, error) => {\n          if (!error) {\n            logger.info('OpenChannel | Fetching messages succeeded', messages);\n            const hasMore = (messages && messages.length > 0);\n            const lastMessageTimestamp = hasMore\n            ? messages[0].createdAt\n            : null;\n            messagesDispatcher({\n              type: messageActionTypes.GET_PREV_MESSAGES_SUCESS,\n              payload: {\n                currentOpenChannel,\n                messages,\n                hasMore,\n                lastMessageTimestamp,\n              },\n            });\n            setTimeout(() => {\n              utils.scrollIntoLast('.sendbird-msg--scroll-ref');\n            });\n          } else {\n            logger.error('OpenChannel | Fetching messages failed', error);\n            messagesDispatcher({\n              type: messageActionTypes.GET_PREV_MESSAGES_FAIL,\n              payload: {\n                currentOpenChannel,\n                messages: [],\n                hasMore: false,\n                lastMessageTimestamp: 0,\n              },\n            });\n          }\n        },\n      );\n      // todo: use promise after CoreSDK adds required TS methods\n      // .then((messages) => {\n      //   console.log('get messages via getMessagesByTimestamp', messages);\n      //   const hasMore = (messages && messages.length > 0);\n      //   const lastMessageTimestamp = hasMore\n      //     ? messages[0].createdAt\n      //     : null;\n      //   messagesDispatcher({\n      //     type: messageActionTypes.GET_PREV_MESSAGES_SUCESS,\n      //     payload: {\n      //       currentOpenChannel,\n      //       messages,\n      //       hasMore,\n      //       lastMessageTimestamp,\n      //     },\n      //   });\n      // })\n      // .catch((error: Error): void => {\n      //   logger.error('OpenChannel | Fetching messages failed', error);\n      //   messagesDispatcher({\n      //     type: messageActionTypes.GET_PREV_MESSAGES_FAIL,\n      //     payload: {\n      //       currentOpenChannel,\n      //       messages: [],\n      //       hasMore: false,\n      //       lastMessageTimestamp: 0,\n      //     }\n      //   });\n      // });\n    }\n  }, [currentOpenChannel]);\n\n  // useScrollCallback\n  const onScroll = useCallback((callback) => {\n    if (!hasMore) {\n      return;\n    }\n    const messageListParams = new sdk.MessageListParams();\n    messageListParams.prevResultSize = 30;\n    messageListParams.includeReplies = false;\n    messageListParams.includeReactions = false;\n\n    if (userFilledMessageListParams) {\n      Object.keys(userFilledMessageListParams).forEach(key => {\n        messageListParams[key] = userFilledMessageListParams[key];\n      });\n      logger.info('OpenChannel: Used userFilledMessageListParams');\n    }\n\n    logger.info('OpenChannel: Fetching messages', { currentOpenChannel, messageListParams });\n\n    currentOpenChannel.getMessagesByTimestamp(\n      lastMessageTimestamp || new Date().getTime(),\n      messageListParams,\n      (messages, error) => {\n        if (!error) {\n          logger.info('OpenChannel | Fetching messages succeeded', messages);\n          const hasMore = (messages && messages.length > 0);\n          const lastMessageTimestamp = hasMore\n            ? messages[0].createdAt\n            : null;\n          messagesDispatcher({\n            type: messageActionTypes.GET_PREV_MESSAGES_SUCESS,\n            payload: {\n              currentOpenChannel,\n              messages,\n              hasMore,\n              lastMessageTimestamp,\n            },\n          });\n          setTimeout(() => {\n            callback();\n          });\n        } else {\n          logger.error('OpenChannel | Fetching messages failed', error);\n          messagesDispatcher({\n            type: messageActionTypes.GET_PREV_MESSAGES_FAIL,\n            payload: {\n              currentOpenChannel,\n              messages: [],\n              hasMore: false,\n              lastMessageTimestamp: 0,\n            },\n          });\n        }\n      }\n    );\n  }, [currentOpenChannel, lastMessageTimestamp]);\n\n  // useSendMessageCallback\n  const handleSendMessage = useCallback(() => {\n    const text = messageInputRef.current.value;\n\n    function createParamsDefualt(txt: string | number): Sendbird.UserMessageParams {\n      const message = typeof txt === 'string' ? txt.trim() : txt.toString(10).trim();\n      const params = new sdk.UserMessageParams();\n      params.message = message;\n      return params;\n    }\n\n    const createCustomParams = onBeforeSendUserMessage\n      && typeof onBeforeSendUserMessage === 'function';\n\n    if (createCustomParams) {\n      logger.info('OpenChannel | Creating params using onBeforeSendUserMessage', onBeforeSendUserMessage);\n    }\n\n    const params = onBeforeSendUserMessage\n      ? onBeforeSendUserMessage(text)\n      : createParamsDefualt(text);\n\n    logger.info('OpenChannel | Sending message has started', params);\n\n    const pendingMessage = currentOpenChannel.sendUserMessage(params, (message, error) => {\n      if (error) {\n        logger.warning('OpenChannel | Sending message failed', { message });\n        messagesDispatcher({\n          type: messageActionTypes.SENDING_MESSAGE_FAILED,\n          payload: message,\n        });\n        return;\n      }\n      logger.info('OpenChannel | Sending message succeeded', { message });\n      messagesDispatcher({\n        type: messageActionTypes.SENDING_MESSAGE_SUCCEEDED,\n        payload: message,\n      });\n    });\n    messagesDispatcher({\n      type: messageActionTypes.SENDING_MESSAGE_START,\n      payload: {\n        message: pendingMessage,\n        channel: currentOpenChannel,\n      },\n    });\n  }, [currentOpenChannel, onBeforeSendUserMessage]);\n\n  // useFileUploadCallback\n  const handleFileUpload = useCallback((file) => {\n    function createParamsDefualt(file_: File): Sendbird.FileMessageParams {\n      const params = new sdk.FileMessageParams();\n      params.file = file_;\n      return params;\n    }\n\n    const createCustomParams = onBeforeSendFileMessage\n      && typeof onBeforeSendFileMessage === 'function';\n\n    if (createCustomParams) {\n      logger.info('OpenChannel | Creating params using onBeforeSendFileMessage', onBeforeSendFileMessage);\n    }\n\n    const params = onBeforeSendFileMessage\n      ? onBeforeSendFileMessage(file)\n      : createParamsDefualt(file);\n\n    logger.info('OpenChannel | Uploading file message start', params);\n\n    const pendingMessage = currentOpenChannel.sendFileMessage(\n      params,\n      (message: EveryMessage, error: Sendbird.SendBirdError) => {\n        if (error) {\n          logger.error('OpenChannel | Sending file message failed', { message, error });\n          message.localUrl = URL.createObjectURL(file);\n          message.file = file;\n          messagesDispatcher({\n            type: messageActionTypes.SENDING_MESSAGE_FAILED,\n            payload: message,\n          });\n          return;\n        }\n        logger.info('OpenChannel | Sending message succeeded', message);\n        messagesDispatcher({\n          type: messageActionTypes.SENDING_MESSAGE_SUCCEEDED,\n          payload: message,\n        });\n      }\n    );\n\n    messagesDispatcher({\n      type: messageActionTypes.SENDING_MESSAGE_START,\n      payload: {\n        message: {\n          ...pendingMessage,\n          url: URL.createObjectURL(file),\n          // pending thumbnail message seems to be failed\n          requestState: 'pending',\n        },\n        channel: currentOpenChannel,\n      }\n    });\n  }, [currentOpenChannel, onBeforeSendFileMessage]);\n\n  // useUpdateMessageCallback\n  const updateMessage = useCallback((messageId: number, text: string, callback?: () => void): void => {\n\n    function createParamsDefualt(txt: string): SendBird.UserMessageParams {\n      const params = new sdk.UserMessageParams();\n      params.message = txt;\n      return params;\n    }\n\n    if (onBeforeSendUserMessage && typeof onBeforeSendUserMessage === 'function') {\n      logger.info('OpenChannel | Creating params using onBeforeUpdateUserMessage');\n    }\n\n    const params = onBeforeSendUserMessage\n      ? onBeforeSendUserMessage(text)\n      : createParamsDefualt(text);\n\n    currentOpenChannel.updateUserMessage(messageId, params, (message, error) => {\n      if (callback) {\n        callback();\n      }\n      if (!error) {\n        logger.info('OpenChannel | Updating message succeeded', { message, params });\n        messagesDispatcher({\n          type: messageActionTypes.ON_MESSAGE_UPDATED,\n          payload: {\n            channel: currentOpenChannel,\n            message,\n          },\n        });\n      } else {\n        logger.warning('OpenChannel | Updating message failed', error);\n      }\n    });\n  }, [currentOpenChannel, messagesDispatcher, onBeforeSendUserMessage]);\n\n  // useDeleteMessageCallback\n  const deleteMessage = useCallback((message: ClientUserMessage | ClientFileMessage, callback?: () => void): void => {\n    logger.info('OpenChannel | useDeleteMessageCallback: Deleting message', message);\n    const { requestState } = message;\n    logger.info('OpenChannel | useDeleteMessageCallback: Deleting message requestState: ', requestState);\n\n    if (requestState === 'failed' || requestState === 'pending') {\n      logger.info('OpenChannel | useDeleteMessageCallback: Deleted message from local: ', message);\n      messagesDispatcher({\n        type: messageActionTypes.ON_MESSAGE_DELETED_BY_REQ_ID,\n        payload: message.reqId,\n      });\n      if (callback) {\n        callback();\n      }\n      return;\n    }\n\n    currentOpenChannel.deleteMessage(message, (error) => {\n      logger.info('OpenChannel | useDeleteMessageCallback: Deleting message from remote: ', requestState);\n      if (callback) {\n        callback();\n      }\n      if (!error) {\n        logger.info('OpenChannel | useDeleteMessageCallback: Deleting message succeeded', message);\n        messagesDispatcher({\n          type: messageActionTypes.ON_MESSAGE_DELETED,\n          payload: {\n            channel: currentOpenChannel,\n            messageId: message.messageId,\n          },\n        });\n      } else {\n        logger.warning('OpenChannel | useDeleteMessageCallback: Deleting message failed', error);\n      }\n    });\n  }, [currentOpenChannel, messagesDispatcher]);\n\n  // useResendMessageCallback\n  const resendMessage = useCallback((failedMessage: ClientUserMessage | ClientFileMessage) => {\n    logger.info('OpenChannel | Reseding message has started', failedMessage);\n    const { messageType, file } = failedMessage;\n    if (failedMessage && typeof failedMessage.isResendable === 'function' && failedMessage.isResendable()) {\n      // eslint-disable-next-line no-param-reassign\n      failedMessage.requestState = 'pending';\n      messagesDispatcher({\n        type: messageActionTypes.RESENDING_MESSAGE_START,\n        payload: {\n          channel: currentOpenChannel,\n          message: failedMessage,\n        },\n      });\n\n      // userMessage\n      if (messageType === 'user' && failedMessage.messageType === 'user') {\n        currentOpenChannel.resendUserMessage(failedMessage, (message, error) => {\n          if (!error) {\n            logger.info('OpenChannel | Reseding message succeeded', message);\n            messagesDispatcher({\n              type: messageActionTypes.SENDING_MESSAGE_SUCCEEDED,\n              payload: message,\n            });\n          } else {\n            logger.warning('OpenChannel | Resending message failed', error);\n            // eslint-disable-next-line no-param-reassign\n            failedMessage.requestState = 'failed';\n            messagesDispatcher({\n              type: messageActionTypes.SENDING_MESSAGE_FAILED,\n              payload: failedMessage,\n            });\n          }\n        });\n        return;\n      }\n\n      // fileMessage\n      if (messageType === 'file' && failedMessage.messageType === 'file') {\n        currentOpenChannel.resendFileMessage(failedMessage, file, (message, error) => {\n          if (!error) {\n            logger.info('OpenChannel | Resending file message succeeded', message);\n            messagesDispatcher({\n              type: messageActionTypes.SENDING_MESSAGE_SUCCEEDED,\n              payload: message,\n            });\n          } else {\n            logger.warning('OpenChannel | Resending file message failed', error);\n            // eslint-disable-next-line no-param-reassign\n            failedMessage.requestState = 'failed';\n            messagesDispatcher({\n              type: messageActionTypes.SENDING_MESSAGE_FAILED,\n              payload: failedMessage,\n            });\n          }\n        });\n      }\n    } else {\n      // to alert user on console\n      // eslint-disable-next-line no-console\n      console.error('OpenChannel | Message is not resendable');\n      logger.warning('OpenChannel | Message is not resendable', failedMessage);\n    }\n  }, [currentOpenChannel, messagesDispatcher]);\n\n  const handleClickScrollDownButton = () => {\n    const promise = new Promise((resolve) => {\n      resolve();\n    });\n    setScrollDownPromise(promise);\n  };\n\n  if (!currentOpenChannel || !currentOpenChannel.url) {\n    return (<div className={COMPONENT_CLASS_NAME}><PlaceHolder type={PlaceHolderTypes.NO_CHANNELS} /></div>);\n  }\n  if (loading) {\n    return (<div className={COMPONENT_CLASS_NAME}><PlaceHolder type={PlaceHolderTypes.LOADING} /></div>);\n  }\n  if (isInvalid) {\n    return (<div className={COMPONENT_CLASS_NAME}><PlaceHolder type={PlaceHolderTypes.WRONG} /></div>);\n  }\n\n  return (\n    <UserProfileProvider\n      className={COMPONENT_CLASS_NAME}\n      disableUserProfile={userDefinedDisableUserProfile}\n      renderUserProfile={userDefinedRenderProfile}\n    >\n      {\n        showScrollDownButton && (\n          <div\n            className={`${COMPONENT_CLASS_NAME}__go-to-bottom`}\n            onClick={handleClickScrollDownButton}\n            onKeyDown={handleClickScrollDownButton}\n            tabIndex={0}\n            role=\"button\"\n          >\n            <Icon\n              width=\"24px\"\n              height=\"24px\"\n              type={IconTypes.SHEVRON_DOWN}\n              fillColor={IconColors.CONTENT}\n            />\n          </div>\n        )\n      }\n      {\n        renderChannelTitle\n          ? renderChannelTitle({\n            channel: currentOpenChannel,\n            user: user,\n          })\n          : (\n            <OpenchannelConversationHeader\n              title={currentOpenChannel.name}\n              subTitle={`${utils.kFormatter(currentOpenChannel.participantCount)} ${stringSet.OPEN_CHANNEL_CONVERSATION__TITLE_PARTICIPANTS}`}\n              coverImage={currentOpenChannel.coverUrl}\n              onActionClick={onChatHeaderActionClick}\n            />\n          )\n      }\n      {\n        currentOpenChannel.isFrozen && (\n          <FrozenChannelNotification />\n        )\n      }\n      <OpenchannelConversationScroll\n        renderCustomMessage={renderCustomMessage}\n        openchannel={currentOpenChannel}\n        user={user}\n        useMessageGrouping={useMessageGrouping}\n        isOnline={isOnline}\n        allMessages={allMessages}\n        onScroll={onScroll}\n        hasMore={hasMore}\n        scrollDownPromise={scrollDownPromise}\n        showScrollDownButton={setShowScrollDownButton}\n        updateMessage={updateMessage}\n        deleteMessage={deleteMessage}\n        resendMessage={resendMessage}\n      />\n      {\n        renderMessageInput\n          ? (\n            renderMessageInput({\n              channel: currentOpenChannel,\n              user: user,\n              disabled: disabled,\n            })\n          )\n          : (\n            <MessageInputWrapper\n              channel={currentOpenChannel}\n              user={user}\n              ref={messageInputRef}\n              disabled={disabled}\n              onSendMessage={handleSendMessage}\n              onFileUpload={handleFileUpload}\n              renderMessageInput={renderMessageInput}\n            />\n          )\n      }\n    </UserProfileProvider>\n  );\n};\n\nexport default withSendbirdContext(OpenchannelConversation);\n"],"names":["getMessageCreatedAt","message","format","createdAt","scrollIntoLast","selector","intialTry","MAX_TRIES","currentTry","nodes","document","querySelectorAll","last","length","scrollIntoView","error","setTimeout","isSameGroup","comparingMessage","messageType","sendingStatus","sender","userId","compareMessagesForGrouping","prevMessage","currMessage","nextMessage","kFormatter","num","Math","abs","toFixed","isOperator","openChannel","operators","map","operator","indexOf","isDisabledBecauseFrozen","isFrozen","MessageInputWrapper","_a","ref","channel","user","disabled","onSendMessage","onFileUpload","renderMessageInput","stringSet","useContext","LocalizationContext","CHANNEL__MESSAGE_INPUT__PLACE_HOLDER__DISABLED","React","forwardRef","FrozenNotification","LabelTypography","CAPTION_2","CHANNEL_FROZEN","COMPONENT_CLASS_NAME","OpenchannelConversationHeader","coverImage","_b","title","LabelStringSet","NO_TITLE","_c","subTitle","onActionClick","IconTypes","AVATAR_NO_IMAGE","IconColors","BACKGROUND_3","H_2","LabelColors","ONBACKGROUND_1","BODY_2","ONBACKGROUND_2","INFO","PRIMARY","copyToClipboard","text","window","clipboardData","setData","queryCommandSupported","textarea","createElement","textContent","style","position","body","appendChild","select","execCommand","ex","removeChild","OpenChannelMessageStatusTypes","NONE","PENDING","FAILED","CANCELED","SUCCEEDED","getSenderFromMessage","_sender","checkIsSent","status","checkIsByMe","isFineCopy","isFineResend","isResendable","isFineEdit","isFineDelete","showMenuTrigger","props","OpenchannelUserMessage","className","resendMessage","showEdit","showRemove","chainTop","UserProfileContext","disableUserProfile","renderUserProfile","messageRef","useRef","avatarRef","contextMenuRef","useState","contextStyle","setContextStyle","injectingClassName","Array","isArray","push","isByMe","MemoizedMessageText","useMemo","splitMessage","split","matchedMessage","word","updatedAt","uuidv4","BODY_1","MESSAGE_EDITED","useEffect","current","clientHeight","top","innerWidth","join","toggleDropdown","profileUrl","closeDropdown","paddingTop","paddingBottom","close","SECONDARY_3","friendName","nickname","CAPTION_3","ONBACKGROUND_3","MORE","CONTENT_INVERSE","CONTEXT_MENU_DROPDOWN__COPY","CONTEXT_MENU_DROPDOWN__EDIT","CONTEXT_MENU_DROPDOWN__RESEND","CONTEXT_MENU_DROPDOWN__DELETE","OpenChannelAdminMessage","__spreadArrays","URL_REG","createUrlTester","regexp","test","checkOGIsEnalbed","ogMetaData","url","OpenchannelOGMessage","defaultImage","messageComponentRef","isUrl","wordClassName","openLink","open","SUBTITLE_2","description","alt","NO_THUMBNAIL","SUPPORTING_TYPES","IMAGE","VIDEO","UNSUPPORTED","SUPPORTED_MIMES","getSupportingFileType","type","OpenchannelThumbnailMessage","onClick","localUrl","isMessageSent","PLAY","PHOTO","ON_BACKGROUND_2","checkFileType","fileUrl","result","imageFile","audioFile","FILE_DOCUMENT","FILE_AUDIO","truncate","fullStr","strLen","undefined","separator","sepLen","charsToShow","frontChars","ceil","backChars","floor","substr","OpenchannelFileMessage","openFileUrl","RemoveMessageModal","onCloseModal","onDeleteMessage","MODAL__DELETE_MESSAGE__TITLE","MessageTypes","ADMIN","USER","FILE","THUMBNAIL","OG","UNKNOWN","SendingMessageStatus","getMessageType","isUserMessage","isAdminMessage","isImage","isVideo","MessageHoc","editDisabled","hasSeperator","renderCustomMessage","deleteMessage","updateMessage","chainBottom","RenderedMessage","setShowEdit","_d","setShowRemove","_e","showFileViewer","setShowFileViewer","editMessageInputRef","requestState","messageId","OpenChannelFileMessage","OpenChannelOGMessage","OpenChannelThumbnailMessage","OpenChannelUserMessage","OpenchannelConversationScroll","useMessageGrouping","openchannel","allMessages","isOnline","hasMore","onScroll","scrollDownPromise","showScrollDownButton","scrollRef","handleOnScroll","e","element","target","scrollTop","scrollHeight","nodes_1","first","then","scrollTo","index","previousMessage","previousMessageCreatedAt","currentCreatedAt","isSameDay","SET_CURRENT_CHANNEL","SET_CHANNEL_INVALID","RESET_MESSAGES","GET_PREV_MESSAGES_SUCESS","GET_PREV_MESSAGES_FAIL","SENDING_MESSAGE_FAILED","SENDING_MESSAGE_SUCCEEDED","SENDING_MESSAGE_START","RESENDING_MESSAGE_START","ON_MESSAGE_RECEIVED","ON_MESSAGE_UPDATED","ON_MESSAGE_DELETED","ON_MESSAGE_DELETED_BY_REQ_ID","ON_OPERATOR_UPDATED","ON_USER_ENTERED","ON_USER_EXITED","ON_USER_MUTED","ON_USER_UNMUTED","ON_USER_BANNED","ON_USER_UNBANNED","ON_CHANNEL_FROZEN","ON_CHANNEL_UNFROZEN","ON_CHANNEL_CHANGED","ON_META_DATA_CREATED","ON_META_DATA_UPDATED","ON_META_DATA_DELETED","ON_META_COUNTERS_CREATED","ON_META_COUNTERS_UPDATED","ON_META_COUNTERS_DELETED","ON_MENTION_RECEIVED","reducer","state","action","actionTypes","currentChannel","payload","isInvalid","currentOpenChannel","participants","isFailed","messages","lastMessageTimestamp","actionChannelUrl","receivedMessages_1","_hasMore","_lastMessageTimestamp","stateChannel","stateChannelUrl","filteredAllMessages","filter","find","compareIds","loading","initialized","sentMessage_1","newMessages","m","reqId","sentMessage_2","eventedChannel","resentMessage_1","receivedMessage","updatedMessage_1","isIdentical","deletedMessageId_1","updatedOperators","enteredUser","exitedUser_1","participant","frozenChannel","frozen","unfrozenChannel","changedChannel","initialState","OpenchannelConversation","channelUrl","stores","config","queries","renderChannelTitle","onBeforeSendUserMessage","onBeforeSendFileMessage","onChatHeaderActionClick","sdkStore","userStore","logger","pubSub","sdk","useReducer","messagesReducer","messagesInitialState","messagesStore","messagesDispatcher","messageInputRef","setScrollDownPromise","setShowScrollDownButton","sdkInit","userFilledMessageListParams","messageListParams","utils","userDefinedDisableUserProfile","userDefinedRenderProfile","OpenChannel","info","getChannel","messageActionTypes","enter","warning","subscriber","Map","subscribe","set","topics","msg","fromSelector","forEach","s","remove","messageReceiverId","ChannelHandler","onMessageReceived","onMessageUpdated","onMessageDeleted","onOperatorUpdated","onUserEntered","onUserExited","onUserMuted","onUserUnmuted","onUserBanned","onUserUnbanned","onChannelFrozen","onChannelUnfrozen","onChannelChanged","onMetaDataCreated","metaData","onMetaDataUpdated","onMetaDataDeleted","metaDataKeys","onMetaCountersCreated","metaCounter","onMetaCountersUpdated","onMetaCountersDeleted","metaCounterKeys","onMentionReceived","addChannelHandler","removeChannelHandler","MessageListParams","getMessagesByTimestamp","messageListParams_1","prevResultSize","isInclusive","includeReplies","includeReactions","Object","keys","key","Date","getTime","hasMore_1","lastMessageTimestamp_1","useCallback","callback","hasMore_2","lastMessageTimestamp_2","handleSendMessage","value","createParamsDefualt","txt","trim","toString","params","UserMessageParams","createCustomParams","pendingMessage","sendUserMessage","handleFileUpload","file","file_","FileMessageParams","sendFileMessage","URL","createObjectURL","updateUserMessage","failedMessage","resendUserMessage","resendFileMessage","console","handleClickScrollDownButton","promise","Promise","resolve","PlaceHolderTypes","NO_CHANNELS","LOADING","WRONG","SHEVRON_DOWN","CONTENT","name","participantCount","OPEN_CHANNEL_CONVERSATION__TITLE_PARTICIPANTS","coverUrl","FrozenChannelNotification","withSendbirdContext"],"mappings":"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"}